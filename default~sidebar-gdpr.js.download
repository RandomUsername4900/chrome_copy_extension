(window.webpackJsonp=window.webpackJsonp||[]).push([["default~sidebar-gdpr"],{"4gww":function(e,s){function t(){}e.exports=t},"7vvg":function(e,s){function t(e,s){var t=e.length;e.sort(s);for(;t--;)e[t]=e[t].value;return e}e.exports=t},"BmF+":function(e,s){e.exports={moveSubscriptionTypeToBusinessUnit:{name:"move subscription type to business unit",class:"interaction",properties:{appName:{type:"string"},subscriptionId:{type:"number"},currentBusinessUnitId:{type:"number"},targetBusinessUnitId:{type:"number"}},namespace:"subscription-components",version:"1"},subscriptionStatusTableSubscribe:{name:"subscribe via subscription status table",class:"interaction",properties:{appName:{type:"string"},legalBasis:{type:["LEGITIMATE_INTEREST_PQL","LEGITIMATE_INTEREST_CLIENT","PERFORMANCE_OF_CONTRACT","CONSENT_WITH_NOTICE","NON_GDPR","PROCESS_AND_STORE","LEGITIMATE_INTEREST_OTHER"]}},namespace:"subscription-components",version:"1"},subscriptionStatusTableResubscribe:{name:"resubscribe via subscription status table",class:"interaction",properties:{appName:{type:"string"},legalBasis:{type:["LEGITIMATE_INTEREST_PQL","LEGITIMATE_INTEREST_CLIENT","PERFORMANCE_OF_CONTRACT","CONSENT_WITH_NOTICE","NON_GDPR","PROCESS_AND_STORE","LEGITIMATE_INTEREST_OTHER"]}},namespace:"subscription-components",version:"1"},subscriptionStatusTableUnsubscribe:{name:"unsubscribe via subscription status table",class:"interaction",properties:{appName:{type:"string"}},namespace:"subscription-components",version:"1"},subscriptionsStatusPanelOpened:{name:"subscriptions status panel opened",class:"interaction",properties:{appName:{type:"string"}},namespace:"subscription-components",version:"1"},subscriptionsHistoryTabOpened:{name:"subscriptions history tab opened",class:"interaction",properties:{appName:{type:"string"}},namespace:"subscription-components",version:"1"}}},Bv16:function(e,s,t){"use strict";var i=t("QgEn"),n=t("npjq"),a=t("DSKb"),r=t("uzdC"),o=t("w3lB");const c=({hideConsent:e=!1,hideContract:s=!1,showHelpText:t=!1,hideNonGdpr:i=!1})=>{const a=[Object.assign({text:n.a.text("options.lawfulBasis."+o.b.LEGITIMATE_INTEREST_PQL),value:o.b.LEGITIMATE_INTEREST_PQL},t&&{help:n.a.text("options.lawfulBasis.help."+o.b.LEGITIMATE_INTEREST_PQL)}),Object.assign({text:n.a.text("options.lawfulBasis."+o.b.LEGITIMATE_INTEREST_CLIENT),value:o.b.LEGITIMATE_INTEREST_CLIENT},t&&{help:n.a.text("options.lawfulBasis.help."+o.b.LEGITIMATE_INTEREST_CLIENT)}),Object.assign({text:n.a.text("options.lawfulBasis."+o.b.LEGITIMATE_INTEREST_OTHER),value:o.b.LEGITIMATE_INTEREST_OTHER},t&&{help:n.a.text("options.lawfulBasis.help."+o.b.LEGITIMATE_INTEREST_OTHER)})];s||a.push(Object.assign({text:n.a.text("options.lawfulBasis."+o.b.PERFORMANCE_OF_CONTRACT),value:o.b.PERFORMANCE_OF_CONTRACT},t&&{help:n.a.text("options.lawfulBasis.help."+o.b.PERFORMANCE_OF_CONTRACT)}));e||a.push(Object.assign({text:n.a.text("options.lawfulBasis."+o.b.CONSENT_WITH_NOTICE),value:o.b.CONSENT_WITH_NOTICE},t&&{help:n.a.text("options.lawfulBasis.help."+o.b.CONSENT_WITH_NOTICE)}));i||a.push(Object.assign({text:n.a.text("options.lawfulBasis."+o.b.NON_GDPR),value:o.b.NON_GDPR},t&&{help:n.a.text("options.lawfulBasis.help."+o.b.NON_GDPR)}));return a},u=e=>Object(i.jsx)(r.a,Object.assign({label:n.a.text("labels.lawfulBasis")},e.formControlProps,{children:Object(i.jsx)(a.a,Object.assign({placeholder:n.a.text("placeholders.lawfulBasis")},e,{options:c(e),dropdownClassName:"untruncate","data-selenium-test":"gdpr-legal-basis-select"}))}));s.a=u},C3JH:function(e,s,t){var i=t("T+Pj"),n=t("MNan");function a(e,s){var t=-1,a=n(e)?Array(e.length):[];i(e,(function(e,i,n){a[++t]=s(e,i,n)}));return a}e.exports=a},DwG8:function(e,s,t){var i=t("qrlA");function n(e){return e&&e.length?i(e):[]}e.exports=n},EFWH:function(e,s,t){var i=t("FU2H");function n(e,s){if(e!==s){var t=void 0!==e,n=null===e,a=e==e,r=i(e),o=void 0!==s,c=null===s,u=s==s,l=i(s);if(!c&&!l&&!r&&e>s||r&&o&&u&&!c&&!l||n&&o&&u||!t&&u||!a)return 1;if(!n&&!r&&!l&&e<s||l&&t&&a&&!n&&!r||c&&t&&a||!o&&a||!u)return-1}return 0}e.exports=n},GXF8:function(e,s,t){var i=t("+a0K"),n=t("MNan"),a=t("qqya"),r=t("kmmH");function o(e,s,t){if(!r(t))return!1;var o=typeof s;return!!("number"==o?n(t)&&a(s,t.length):"string"==o&&s in t)&&i(t[s],e)}e.exports=o},KOqu:function(e,s,t){"use strict";t.r(s);var i=t("QgEn"),n=t("m9st"),a=t("E7+s"),r=t("G/lG"),o=t("af+D"),c=t("TgAf"),u=t("sPSZ"),l=t("sl/w"),b=t("oxA8"),d=t("VfuR"),p=t.n(d),O=t("npjq"),S=t("Bv16"),h=t("muUi"),j=t("xA3K"),m=t("QYOI"),T=t("Ktcs");const E="DEFAULT",g=(e="",s="",t)=>0===e.length&&0===s.length?t:`${e} ${s} | ${t}`,C=({preferencesGroup:{name:e,id:s}})=>({text:e,value:s}),f=(e,s,t,i)=>[{text:i||O.a.text("labels.defaultSubscriptionTypes"),value:E},...e.reduce((e,i)=>!s||t.includes(i.preferencesGroup.id)?[...e,C(i)]:e,[])],x=(e,s,t,i,n=[],a=!1)=>e.translatedSubscriptionDefinitions.reduce((e,{subscriptionDefinition:{id:r,name:o,defaultSubscription:c,process:u,operation:l,internal:b}})=>{const d=!!c,p=n.includes(r),O=a&&(b||u&&"Marketing"!==u);return p||d!==s||!t&&b?e:[...e,{text:i?g(u,l,o):o,disabled:O,value:r}]},[]),I=(e,s,t,i,n,a)=>{if(s===E&&e.length)return x(e[0],!0,t,i,n,a);const r=e.find(({preferencesGroup:{id:e}})=>s===e);return r?x(r,!1,t,i,n,a):[]},_=(e,s)=>{let t;const i=e.find(e=>{const i=e.translatedSubscriptionDefinitions.find(({subscriptionDefinition:{id:e}})=>e===s);i&&i.subscriptionDefinition.defaultSubscription&&(t=E);return!!i});return t||(i?i.preferencesGroup.id:null)},R=(e,s)=>{for(let t=0;t<e.length;t++){const i=e[t].translatedSubscriptionDefinitions.find(({subscriptionDefinition:{id:e}})=>e===s);if(i)return i.subscriptionDefinition}return null};var N=t("Pw6n"),A=t("uzdC"),P=t("Tqy5"),U=t("DSKb"),y=t("g+dq"),M=t.n(y);const D={timeout:[3e4],retries:2},B=(e=!1)=>M.a.get("email/v1/subscriptions/definitions",Object.assign({},D,{query:{includeInternal:!e}})),v=()=>M.a.get("/cos-domains/v1/brands",D),L=(e=!1)=>M.a.get("/subscriptions/v1/preferences-group/all/with-permissions",Object.assign({},D,{query:{includeInactive:e}})),G=(e=null)=>M.a.get(`subscriptions/v1/timeline/EMAIL/${e}/full-timeline`,Object.assign({},D)),w=e=>e.map(e=>({text:g(e.category,e.channel,e.name),value:e.id})),F=(e,{hideInternal:s,showInactive:t,hideIds:i,customFilter:n})=>e.filter(e=>!(s&&e.internal||!t&&!e.active||i.has(e.id))).filter(n||(()=>!0));class H extends T.Component{constructor(e){super(e);this.onChange=this.onChange.bind(this);this.onSelectAllChange=this.onSelectAllChange.bind(this);this.getDropdownFooter=this.getDropdownFooter.bind(this);this.state={subscriptions:[],options:[],isLoading:!0,hideIds:Object(m.Set)(e.hideIds),value:null}}componentDidMount(){const{hideInternal:e=!1,showInactive:s=!1,customFilter:t}=this.props,{hideIds:i}=this.state;B(e).then(({subscriptionDefinitions:n})=>{const a=F(n,{hideInternal:e,showInactive:s,hideIds:i,customFilter:t});this.setState({subscriptions:a,options:w(a),isLoading:!1})})}componentDidUpdate(){const{hideIds:e,options:s,value:t}=this.state,i=Object(m.Set)(this.props.hideIds),n={};if(!Object(m.is)(e,i)){n.options=s.filter(e=>e.value===t||!i.has(e.value));n.hideIds=i}n.hasOwnProperty("options")&&this.setState(Object.assign({},n))}getDropdownFooter(){const{options:e}=this.state,{value:s,showSelectAllFooter:t=!1,customFooter:n=null,multi:a}=this.props,r=s&&(!a||s.length>0),o=a&&t,c=o&&r&&e.every(e=>s.includes(e.value));return n||(o?Object(i.jsx)(P.a,{checked:c,indeterminate:r,onChange:this.onSelectAllChange,children:Object(i.jsx)(l.a,{message:"labels.subscriptionTypeSelectAll"})}):null)}onChange({target:{value:e}}){const{subscriptions:s}=this.state,{onChange:t,multi:i}=this.props,n=[];[].concat(e).forEach(e=>{const t=s.filter(s=>s.id===e)[0];t&&!t.category&&(t.category=O.a.text("options.marketing"));t&&!t.channel&&(t.channel=O.a.text("options.email"));n.push(t)});this.setState({value:e});t&&t(i?n||[]:n[0]||null)}onSelectAllChange({target:{checked:e}}){const{options:s}=this.state;e?this.onChange(Object(N.a)(s.map(e=>e.value))):this.onChange(Object(N.a)([]))}render(){const e=this.props,s=Object(j.a)(e,["value"]),{options:t,isLoading:n}=this.state;return Object(i.jsx)(A.a,Object.assign({label:O.a.text("labels.subscriptionType")},this.props.formControlProps,{children:Object(i.jsx)(U.a,Object.assign({placeholder:O.a.text("placeholders.subscriptionType")},n?s:this.props,{options:t,isLoading:n,onChange:this.onChange,dropdownClassName:"untruncate","data-selenium-test":"gdpr-sub-type-select",dropdownFooter:this.getDropdownFooter()}))}))}}var k=H,W=t("66eB");function K(e){return s=>{const{passGroups:t=!1,showInactive:n=!1}=s,[a,r]=Object(T.useState)({groups:[],userAccessibleGroups:[]}),[o,c]=Object(T.useState)(!0);Object(T.useEffect)(()=>{t||L(n).then(({preferencesGroups:e,userAccessibleGroups:s})=>{r({groups:e,userAccessibleGroups:s});c(!1)})},[t,n]);const{userAccessibleGroups:u,groups:l}=a;return t?Object(i.jsx)(e,Object.assign({},s)):Object(i.jsx)(e,Object.assign({groups:l,userAccessibleGroups:u,isLoading:o},s))}}var q=t("nDpY"),V=t.n(q),Q=t("77dM");const Y=(e,s={})=>Object(i.jsx)(A.a,Object.assign({label:Object(i.jsx)(l.a,{message:"labels.subscriptionType"})},s,{children:Object(i.jsx)(U.a,Object.assign({placeholder:Object(i.jsx)(l.a,{message:"placeholders.subscriptionType"}),dropdownClassName:"untruncate","data-selenium-test":"gdpr-sub-type-select"},e))})),$=(e,s)=>Object(i.jsx)(A.a,Object.assign({label:Object(i.jsx)(l.a,{message:"labels.preferenceGroup"}),help:Object(i.jsx)(Q.a,{href:`/settings/${V.a.get()}/marketing/email/preferences-center`,external:!0,children:Object(i.jsx)(l.a,{message:"labels.openPreferenceGroupSettings"})}),tooltip:Object(i.jsx)(l.a,{message:"labels.preferenceGroupHelp"})},s,{children:Object(i.jsx)(U.a,Object.assign({placeholder:Object(i.jsx)(l.a,{message:"placeholders.preferenceGroup"})},e))})),z=e=>{const{value:s,onChange:t,defaultTypesText:n,isLoading:a,formControlsProps:r={},groupFormControlsProps:o={},groupSelectProps:c={},renderTypeSelect:u=Y,renderGroupSelect:l=$,hideIds:b=[],userAccessibleGroups:d=[],onGroupChange:p=W.a,groups:O=[],required:S=!1,canBeEmpty:h=!1,disableNonMarketingTypes:m=!1,withUserAccessibleGroups:g=!0,useGDPRFormattedTypes:x=!0,includeInternal:N=!0}=e,A=Object(j.a)(e,["value","onChange","defaultTypesText","isLoading","formControlsProps","groupFormControlsProps","groupSelectProps","renderTypeSelect","renderGroupSelect","hideIds","userAccessibleGroups","onGroupChange","groups","required","canBeEmpty","disableNonMarketingTypes","withUserAccessibleGroups","useGDPRFormattedTypes","includeInternal"]),P=Object(T.useRef)(s),[U,y]=Object(T.useState)(null),[M,D]=Object(T.useState)(!1),B=Object(T.useCallback)(e=>{p({target:{value:e===E?null:e}});y(e)},[p]);Object(T.useEffect)(()=>{if(P.current&&O.length){const e=_(O,P.current);B(e)}},[O,P,B]);const v=Object(T.useMemo)(()=>f(O,g,d,n),[O,g,d,n]),L=Object(T.useMemo)(()=>U&&U!==E&&g&&!d.includes(U)?[...v,C(O.find(e=>e.preferencesGroup.id===U))]:v,[v,g,d,U,O]),G=Object(T.useMemo)(()=>I(O,U,N,x,b,m),[O,U,N,x,m,b]),w=e=>{D(!0);B(e.target.value);h&&t(null)},F=e=>{D(!1);const s=R(O,e.target.value);(s||h)&&t(s||null)};return Object(i.jsxs)(T.Fragment,{children:[l(Object.assign({},c,{isLoading:a,options:!a&&L,value:U,onChange:w}),Object.assign({required:S},o)),U&&u(Object.assign({},A,{options:!a&&G,value:M?null:s,onChange:F}),Object.assign({required:S},r))]})};z.propTypes={onChange:p.a.func.isRequired,renderTypeSelect:p.a.func.isRequired,renderGroupSelect:p.a.func.isRequired,onGroupChange:p.a.func,value:p.a.number,groups:p.a.array,withUserAccessibleGroups:p.a.bool,userAccessibleGroups:p.a.array,includeInternal:p.a.bool,useGDPRFormattedTypes:p.a.bool,defaultTypesText:p.a.string,required:p.a.bool,canBeEmpty:p.a.bool,disableNonMarketingTypes:p.a.bool,hideIds:p.a.array,isLoading:p.a.bool,formControlsProps:p.a.object,groupFormControlsProps:p.a.object,groupSelectProps:p.a.object};const J=K(z);J.SubscriptionSelect=z;var Z=J;const X=e=>{const{isUngatedForSubscriptionGroups:s,multi:t}=e;return s&&!t?Object(i.jsx)(Z,Object.assign({},e)):Object(i.jsx)(k,Object.assign({},e))};X.propTypes={value:p.a.number,onChange:p.a.func.isRequired,multi:p.a.bool,isUngatedForSubscriptionGroups:p.a.bool};var ee=X,se=t("6KwT"),te=t("0vUY"),ie=t("wZqr"),ne=t.n(ie),ae=t("Oc1M"),re=t.n(ae);const oe={emails:p.a.array.isRequired,handleChange:p.a.func.isRequired,handleSubscriptionChange:p.a.func.isRequired},ce="customerDataEmail.GDPR";class ue extends h.a{constructor(e){super(e);this.partial=re()(ne.a)}render(){const e=this.props.emails.map(e=>({text:e,value:e}));return Object(i.jsxs)(se.a,{children:[Object(i.jsx)(A.a,{label:O.a.text(ce+".inputs.email.label"),required:!0,children:Object(i.jsx)(U.a,{options:e,placeholder:O.a.text(ce+".inputs.email.placeholder"),onChange:this.partial(this.props.handleChange,"email")})}),Object(i.jsx)(ee,{showInactive:!1,formControlProps:{required:!0,label:O.a.text(ce+".inputs.subscriptionTypeSelect.label")},onChange:this.partial(this.props.handleSubscriptionChange,"subscription")}),Object(i.jsx)(S.a,{formControlProps:{required:!0,label:O.a.text(ce+".inputs.lawfulBasisSelectForAddingSubscription.label")},onChange:this.partial(this.props.handleChange,"lawfulBasis")}),Object(i.jsx)(A.a,{label:O.a.text(ce+".inputs.explanation.label"),required:!0,children:Object(i.jsx)(te.a,{placeholder:O.a.text(ce+".inputs.explanation.placeholder"),onChange:this.partial(this.props.handleChange,"explanation")})})]})}}ue.propTypes=oe;var le=ue,be=t("VywG"),de=t("DqRu"),pe=t("BiPx"),Oe=t("QvWB"),Se=t("iVgY"),he=t("iJaT"),je=t("qS8i"),me=t("AuX0"),Te=t("6A2w"),Ee=t("6buU"),ge=t("eY8R"),Ce=t("c/Td"),fe=t.n(Ce),xe=t("vuW9"),Ie=t("CE3l");const _e={emails:p.a.array,handleAddSubscription:p.a.func.isRequired,handleCancel:p.a.func.isRequired,handleClose:p.a.func.isRequired,handleRemoveSubscription:p.a.func.isRequired,handleUpdateSubscription:p.a.func.isRequired,isAddingSubscription:p.a.bool.isRequired,rows:fe.a.list,getLabel:p.a.func.isRequired,canEdit:p.a.bool.isRequired},Re="customerDataEmail.GDPR";class Ne extends h.a{constructor(e){super(e);this.handleSubscriptionChange=(e,s)=>{this.setState({[e]:s.id})};this.handleChange=(e,{target:{value:s}})=>{this.setState({[e]:s})};this.handleCancel=()=>{this.handleResetState();this.props.handleCancel()};this.handleResetState=()=>{this.setState({email:null,subscription:null,lawfulBasis:null,explanation:null,confirmRemovingSubscription:!1})};this.handleSave=()=>{this.props.handleUpdateSubscription(this.state);this.handleCancel()};this.handleDeleteSubscription=()=>{const{email:e,subscription:s}=this.state;this.props.handleRemoveSubscription({lawfulBasis:"NON_GDPR",subscription:s,explanation:"The contact was opted out by a HubSpot user",email:e});this.handleResetState()};this.state={email:null,subscription:null,lawfulBasis:null,explanation:null,confirmRemovingSubscription:!1};this.partial=re()(ne.a);this.renderRow=this.renderRow.bind(this);this.promptDeleteSubscription=this.promptDeleteSubscription.bind(this);this.renderConfirmDeleteModal=this.renderConfirmDeleteModal.bind(this)}promptDeleteSubscription(e,s){this.setState({confirmRemovingSubscription:!0,email:e,subscription:s})}renderConfirmDeleteModal(){const{email:e,subscription:s}=this.state,t=this.props.getLabel(s);return Object(i.jsxs)(he.a,{children:[Object(i.jsxs)(Te.a,{children:[Object(i.jsx)(pe.a,{onClick:this.handleResetState}),Object(i.jsx)(Ie.a,{children:Object(i.jsx)(l.a,{message:Re+".dialogs.addSubscription.table.modal.header"})})]}),Object(i.jsx)(je.a,{children:Object(i.jsx)(b.a,{message:Re+".dialogs.addSubscription.table.modal.body",options:{email:e,label:t}})}),Object(i.jsxs)(me.a,{children:[Object(i.jsx)(de.a,{use:"primary",onClick:this.handleDeleteSubscription,children:Object(i.jsx)(l.a,{message:Re+".dialogs.addSubscription.table.modal.confirm"})}),Object(i.jsx)(de.a,{use:"secondary",onClick:this.handleResetState,children:Object(i.jsx)(l.a,{message:Re+".dialogs.addSubscription.table.modal.cancel"})})]})]})}renderRow({email:e,label:s,id:t}){return Object(i.jsxs)("tr",{children:[Object(i.jsx)(ge.a,{hoverContent:this.props.canEdit&&Object(i.jsx)("span",{children:Object(i.jsx)(de.a,{responsive:!1,size:"extra-small",use:"tertiary-light",onClick:this.partial(this.promptDeleteSubscription,e,t),children:Object(i.jsx)(l.a,{message:Re+".dialogs.addSubscription.table.delete"})})}),children:s}),Object(i.jsx)("td",{children:e})]},`${e}${t}`)}renderTable(){return Object(i.jsxs)("div",{children:[Object(i.jsxs)(Ee.a,{children:[Object(i.jsxs)("colgroup",{children:[Object(i.jsx)("col",{style:{width:400}}),Object(i.jsx)("col",{})]}),Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:Object(i.jsx)(l.a,{message:Re+".dialogs.addSubscription.table.subscriptionType"})}),Object(i.jsx)("th",{children:Object(i.jsx)(l.a,{message:Re+".dialogs.addSubscription.table.email"})})]})}),Object(i.jsx)("tbody",{children:this.props.rows.map(this.renderRow)})]}),this.props.canEdit&&Object(i.jsxs)(de.a,{use:"transparent",onClick:this.props.handleAddSubscription,children:[Object(i.jsx)(Oe.a,{name:"add"}),Object(i.jsx)(l.a,{message:Re+".dialogs.addSubscription.table.add"})]})]})}renderBackButton(){return Object(i.jsx)(be.a,{children:Object(i.jsx)(Q.a,{onClick:this.handleCancel,children:Object(i.jsx)(l.a,{message:Re+".dialogs.addSubscription.back"})})})}renderAddSubscriptionPanel(){return Object(i.jsxs)("div",{children:[this.renderBackButton(),Object(i.jsx)(le,{emails:this.props.emails,handleChange:this.handleChange,handleSubscriptionChange:this.handleSubscriptionChange})]})}renderPanelBody(){const{isAddingSubscription:e}=this.props;return e?this.renderAddSubscriptionPanel():this.renderTable()}render(){const{isAddingSubscription:e}=this.props,{email:s,subscription:t,lawfulBasis:n,explanation:a,confirmRemovingSubscription:r}=this.state;let o=!t||!n||!a;e&&(o=!s||o);return Object(i.jsxs)("div",{children:[Object(i.jsxs)(Se.a,{children:[Object(i.jsxs)(Te.a,{children:[Object(i.jsx)(pe.a,{onClick:this.props.handleClose}),Object(i.jsx)(Ie.a,{children:Object(i.jsx)(l.a,{message:Re+".dialogs.addSubscription.title"})})]}),Object(i.jsx)(je.a,{children:this.renderPanelBody()}),e&&Object(i.jsxs)(me.a,{children:[Object(i.jsx)(xe.a,{disabled:!o,title:Object(i.jsx)(l.a,{message:Re+".buttons.disabled"}),children:Object(i.jsx)(de.a,{use:"primary",onClick:this.handleSave,disabled:o,children:Object(i.jsx)(l.a,{message:Re+".buttons.save"})})}),Object(i.jsx)(de.a,{onClick:this.handleCancel,children:Object(i.jsx)(l.a,{message:Re+".buttons.cancel"})})]})]}),r&&this.renderConfirmDeleteModal()]})}}Ne.propTypes=_e;var Ae=Ne,Pe=t("oWUm"),Ue=t("P4dz"),ye=t("hEU+"),Me=t("0xjy"),De=t("mpvR"),Be=t("1V8t"),ve=t("mLvQ"),Le=t("JCIg");const Ge={query:{clientimeout:7e3}};let we,Fe,He,ke,We,Ke,qe,Ve,Qe,Ye,$e,ze,Je,Ze,Xe,es,ss,ts,is,ns,as,rs,os,cs,us,ls,bs;!function(e){e.UPDATED_BY_SUBSCRIBER="UPDATED_BY_SUBSCRIBER";e.UPDATED_VIA_LINKED_SUBSCRIBER="UPDATED_VIA_LINKED_SUBSCRIBER";e.UPDATED_VIA_HUBSPOT_CUSTOMER="UPDATED_VIA_HUBSPOT_CUSTOMER";e.MIGRATION="MIGRATION"}(we||(we={}));!function(e){e.TERMS="TERMS";e.DATE_HISTOGRAM="DATE_HISTOGRAM";e.HISTOGRAM="HISTOGRAM";e.MISSING="MISSING";e.BUCKETS="BUCKETS";e.TOP_HITS="TOP_HITS"}(Fe||(Fe={}));!function(e){e.SECOND="SECOND";e.MINUTE="MINUTE";e.HOUR="HOUR";e.DAY="DAY";e.WEEK="WEEK";e.MONTH="MONTH";e.QUARTER="QUARTER";e.YEAR="YEAR"}(He||(He={}));!function(e){e.DOUBLE_OPT_IN="DOUBLE_OPT_IN";e.OPT_IN="OPT_IN";e.OPT_OUT="OPT_OUT";e.NOT_OPTED="NOT_OPTED"}(ke||(ke={}));!function(e){e.SOURCE_LIST_UNSUBSCRIBE="SOURCE_LIST_UNSUBSCRIBE";e.SOURCE_IMPORT="SOURCE_IMPORT";e.SOURCE_SPAM_REPORT="SOURCE_SPAM_REPORT";e.SOURCE_NON_DELIVERY_REPORT="SOURCE_NON_DELIVERY_REPORT";e.SOURCE_HUBSPOT="SOURCE_HUBSPOT";e.SOURCE_DIRECT_COMPLAINT="SOURCE_DIRECT_COMPLAINT";e.SOURCE_MTA_RECORD="SOURCE_MTA_RECORD";e.SOURCE_SENDGRID="SOURCE_SENDGRID";e.SOURCE_RECIPIENT="SOURCE_RECIPIENT";e.SOURCE_HUBSPOT_CUSTOMER="SOURCE_HUBSPOT_CUSTOMER";e.SOURCE_MIGRATION="SOURCE_MIGRATION";e.SOURCE_HUBSPOT_CLEANUP="SOURCE_HUBSPOT_CLEANUP";e.SOURCE_KNOWN_SPAM_TRAP="SOURCE_KNOWN_SPAM_TRAP";e.SOURCE_SDFC_SYNC="SOURCE_SDFC_SYNC";e.SOURCE_PUBLIC_API="SOURCE_PUBLIC_API";e.SOURCE_RECIPIENT_VIA_API_GENERATED_TOKEN="SOURCE_RECIPIENT_VIA_API_GENERATED_TOKEN";e.SOURCE_TWO_FIFTY_OK_SPAM_TRAP="SOURCE_TWO_FIFTY_OK_SPAM_TRAP";e.SOURCE_LINKED_PORTAL="SOURCE_LINKED_PORTAL";e.SOURCE_CONVERSATIONS="SOURCE_CONVERSATIONS";e.SOURCE_BOTS="SOURCE_BOTS";e.SOURCE_FORM_SUBMIT="SOURCE_FORM_SUBMIT";e.SOURCE_FEEDBACK_FORM="SOURCE_FEEDBACK_FORM";e.SOURCE_WORKFLOW="SOURCE_WORKFLOW";e.SOURCE_KEYWORD="SOURCE_KEYWORD"}(We||(We={}));!function(e){e.LEGITIMATE_INTEREST_PQL="Legitimate interest – prospect/lead";e.LEGITIMATE_INTEREST_CLIENT="Legitimate interest – existing customer";e.PERFORMANCE_OF_CONTRACT="Performance of a contract";e.CONSENT_WITH_NOTICE="Freely given consent from contact";e.NON_GDPR="Not applicable";e.LEGITIMATE_INTEREST_OTHER="Legitimate interest - other";e.PROCESS_AND_STORE="PROCESS_AND_STORE"}(Ke||(Ke={}));!function(e){e.V1_MIGRATION="V1_MIGRATION";e.API="API";e.PUBLIC_API="PUBLIC_API"}(qe||(qe={}));!function(e){e.EQ="EQ";e.NEQ="NEQ";e.LT="LT";e.LTE="LTE";e.GT="GT";e.GTE="GTE";e.BETWEEN="BETWEEN";e.IN="IN";e.NOT_IN="NOT_IN";e.HAS_PROPERTY="HAS_PROPERTY";e.NOT_HAS_PROPERTY="NOT_HAS_PROPERTY"}(Ve||(Ve={}));!function(e){e.NULL_STATE="NULL_STATE";e.HOLDING_PATTERN="HOLDING_PATTERN";e.STARTED="STARTED";e.CONFIRM_SENT="CONFIRM_SENT";e.CLICKED="CLICKED";e.WELCOME_SENT="WELCOME_SENT";e.HUBSPOT_CONFIRMED="HUBSPOT_CONFIRMED";e.CUSTOMER_CONFIRMED="CUSTOMER_CONFIRMED";e.GRANDFATHER_CONFIRMED="GRANDFATHER_CONFIRMED";e.USER_CONFIRMED="USER_CONFIRMED";e.USER_FORM_SUBMISSION_CONFIRMED="USER_FORM_SUBMISSION_CONFIRMED";e.CONFIRM_STALE="CONFIRM_STALE";e.STATE_TRANSFER="STATE_TRANSFER";e.RESET_NULL_STATE="RESET_NULL_STATE"}(Qe||(Qe={}));!function(e){e.EMAIL="EMAIL";e.EMAIL_PSEUDONYM="EMAIL_PSEUDONYM";e.FORGOTTEN="FORGOTTEN";e.WHATSAPP="WHATSAPP";e.SMS="SMS"}(Ye||(Ye={}));!function(e){e.UNKNOWN="UNKNOWN";e.MIGRATION="MIGRATION";e.EMAIL_NOTIFICATIONS="EMAIL_NOTIFICATIONS";e.SIGNALS="SIGNALS";e.ACCOUNT_NOTIFICATIONS="ACCOUNT_NOTIFICATIONS";e.CRM="CRM";e.SEQUENCES="SEQUENCES";e.FACSIMILE="FACSIMILE";e.CALLING_WIDGET_UI="CALLING_WIDGET_UI";e.SUBSCRIPTIONS_ACCEPTANCE_TESTS="SUBSCRIPTIONS_ACCEPTANCE_TESTS"}($e||($e={}));!function(e){e.ONE_TO_ONE="ONE_TO_ONE";e.MARKETING_INFORMATION="MARKETING_INFORMATION";e.SERVICE_HUB_FEEDBACK="SERVICE_HUB_FEEDBACK";e.WHATSAPP="WHATSAPP";e.TRANSACTIONAL_SMS="TRANSACTIONAL_SMS";e.MARKETING_SMS="MARKETING_SMS"}(ze||(ze={}));!function(e){e.DAY="DAY";e.WEEK="WEEK";e.MONTH="MONTH";e.QUARTER="QUARTER";e.YEAR="YEAR"}(Je||(Je={}));!function(e){e.EPOCH_MILLISECONDS="EPOCH_MILLISECONDS";e.DATE="DATE"}(Ze||(Ze={}));!function(e){e.MILES="MILES";e.KILOMETERS="KILOMETERS"}(Xe||(Xe={}));!function(e){e.DAY="DAY";e.WEEK="WEEK";e.MONTH="MONTH";e.QUARTER="QUARTER";e.YEAR="YEAR"}(es||(es={}));!function(e){e.GLOBAL_BOUNCE="GLOBAL_BOUNCE";e.SUBSCRIPTION_STATUS="SUBSCRIPTION_STATUS";e.SUBSCRIPTION_SPAM_REPORT="SUBSCRIPTION_SPAM_REPORT";e.PORTAL_SPAM_REPORT="PORTAL_SPAM_REPORT";e.PORTAL_STATUS="PORTAL_STATUS";e.ACCOUNT_BOUNCE="ACCOUNT_BOUNCE";e.APP_BOUNCE="APP_BOUNCE";e.PORTAL_BOUNCE="PORTAL_BOUNCE";e.GLOBAL_BLOCK="GLOBAL_BLOCK";e.PORTAL_QUARANTINE="PORTAL_QUARANTINE"}(ss||(ss={}));!function(e){e.SOURCE_LIST_UNSUBSCRIBE="SOURCE_LIST_UNSUBSCRIBE";e.SOURCE_IMPORT="SOURCE_IMPORT";e.SOURCE_SPAM_REPORT="SOURCE_SPAM_REPORT";e.SOURCE_NON_DELIVERY_REPORT="SOURCE_NON_DELIVERY_REPORT";e.SOURCE_HUBSPOT="SOURCE_HUBSPOT";e.SOURCE_DIRECT_COMPLAINT="SOURCE_DIRECT_COMPLAINT";e.SOURCE_MTA_RECORD="SOURCE_MTA_RECORD";e.SOURCE_SENDGRID="SOURCE_SENDGRID";e.SOURCE_RECIPIENT="SOURCE_RECIPIENT";e.SOURCE_HUBSPOT_CUSTOMER="SOURCE_HUBSPOT_CUSTOMER";e.SOURCE_MIGRATION="SOURCE_MIGRATION";e.SOURCE_HUBSPOT_CLEANUP="SOURCE_HUBSPOT_CLEANUP";e.SOURCE_KNOWN_SPAM_TRAP="SOURCE_KNOWN_SPAM_TRAP";e.SOURCE_SDFC_SYNC="SOURCE_SDFC_SYNC";e.SOURCE_PUBLIC_API="SOURCE_PUBLIC_API";e.SOURCE_RECIPIENT_VIA_API_GENERATED_TOKEN="SOURCE_RECIPIENT_VIA_API_GENERATED_TOKEN";e.SOURCE_TWO_FIFTY_OK_SPAM_TRAP="SOURCE_TWO_FIFTY_OK_SPAM_TRAP";e.SOURCE_LINKED_PORTAL="SOURCE_LINKED_PORTAL";e.SOURCE_CONVERSATIONS="SOURCE_CONVERSATIONS";e.SOURCE_BOTS="SOURCE_BOTS";e.SOURCE_FORM_SUBMIT="SOURCE_FORM_SUBMIT";e.SOURCE_FEEDBACK_FORM="SOURCE_FEEDBACK_FORM";e.SOURCE_WORKFLOW="SOURCE_WORKFLOW"}(ts||(ts={}));!function(e){e.LEGITIMATE_INTEREST_PQL="LEGITIMATE_INTEREST_PQL";e.LEGITIMATE_INTEREST_CLIENT="LEGITIMATE_INTEREST_CLIENT";e.PERFORMANCE_OF_CONTRACT="PERFORMANCE_OF_CONTRACT";e.CONSENT_WITH_NOTICE="CONSENT_WITH_NOTICE";e.NON_GDPR="NON_GDPR";e.PROCESS_AND_STORE="PROCESS_AND_STORE";e.LEGITIMATE_INTEREST_OTHER="LEGITIMATE_INTEREST_OTHER"}(is||(is={}));!function(e){e.AND="AND";e.OR="OR"}(ns||(ns={}));!function(e){e.NONE="NONE";e.ANALYZED="ANALYZED";e.RAW="RAW"}(as||(as={}));!function(e){e.ASC="ASC";e.DESC="DESC"}(rs||(rs={}));!function(e){e.SUM="SUM";e.AVG="AVG";e.MIN="MIN";e.MAX="MAX";e.DISTINCT_APPROX="DISTINCT_APPROX";e.PERCENTILES="PERCENTILES";e.COUNT="COUNT"}(os||(os={}));!function(e){e.EMAIL="EMAIL";e.WHATSAPP="WHATSAPP";e.SMS="SMS"}(cs||(cs={}));!function(e){e.UNKNOWN="UNKNOWN";e.CREATE="CREATE";e.UPDATE="UPDATE";e.ACTIVATE="ACTIVATE";e.DEACTIVATE="DEACTIVATE";e.CHANGE_POSITIONS="CHANGE_POSITIONS"}(us||(us={}));!function(e){e.WORKFLOW="WORKFLOW";e.EMAIL_CONTENT="EMAIL_CONTENT"}(ls||(ls={}));!function(e){e.NONE="NONE";e.COMPLY="COMPLY";e.ENFORCE="ENFORCE"}(bs||(bs={}));var ds=t("LZPL"),ps=t.n(ds);const Os=(()=>{switch(ps.a.getHublet()){case"na1":return"";case"eu1":return"-eu1";default:return""}})(),Ss=(V.a.get(),ps.a.isQa("settings-ui"),"Conversations:WhatsApp"),hs="messaging-access",js="Messaging:SMSPrivateBeta",ms="Messaging:SMSAccess",Ts="sms-marketing-addon";var Es=(e,s)=>Object(T.useMemo)(()=>{const t={[cs.EMAIL]:!0,[cs.SMS]:!1,[cs.WHATSAPP]:!1},i=e.includes(Ss),n=s.includes(hs);i&&n&&(t[cs.WHATSAPP]=!0);const a=e.includes(js)&&e.includes(ms),r=s.includes(Ts);a&&r&&(t[cs.SMS]=!0);return t},[e,s]);let gs;var Cs=(e=gs)=>{const[s,t]=Object(T.useState)();Object(T.useEffect)(()=>{const s=e=>{gs=e;t(e)};e?s(e):M.a.get("/data-privacy-settings/hub-settings").then(e=>s(e))},[e]);return s};var fs=(e={})=>Object.keys(e).length<=0?"":"?"+Object.keys(e).filter(s=>void 0!==e[s]).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&");const xs=({options:e,queryParams:s,contactId:t})=>{const i=fs(s);return M.a.get(`subscriptions/v1/status-overview/contact/${t}${i}`,Object.assign({},Ge,{},e))};var Is=e=>{const[s,t]=Object(T.useState)();Object(T.useEffect)(()=>{xs({contactId:e}).then(t)},[e]);return s},_s=t("pG/d"),Rs=t("BmF+"),Ns=t.n(Rs);const As=Object(_s.a)({events:Ns.a});var Ps=As;var Us=({appName:e})=>{Ps.track("subscriptionsStatusPanelOpened",{appName:e})},ys=t("RvQm"),Ms=t("GgP/"),Ds=t.n(Ms),Bs=t("fwt6");const vs=e=>e.includes("business-units:business-unit-users"),Ls=e=>e.includes("business-units-view-all"),Gs=e=>e.includes("business-units-write");var ws=t("A97v"),Fs=t("xg9R");const Hs=({id:e,name:s,logoUrl:t,logoAltText:n,resizedUrl:a})=>{const r=Object(Fs.a)(s,e),o=a||t?{imageUrl:a||t,logoAltText:n}:{avatar:Object(i.jsx)(ws.a,{displayName:r,type:"contact",size:"xl"})};return Object.assign({text:r,value:e},o)},ks=({formattedOptions:e})=>e&&e.length<=1,Ws=({buId:e,buIds:s,multi:t,includeViewAll:i,canViewAll:n,formattedOptions:a,isBusinessUnitOneOption:r,isLoading:o,hasFailed:c})=>{if(o||c||0===a.length)return;if(t)return s;if(i&&void 0===e&&n)return Bs.a;if(r){const e=a.find(e=>e.value!==Bs.a);return e&&e.value}return a.find(s=>s.value===e)?e:void 0},Ks=(e,s)=>{let t=e;s||(t=e.filter(e=>0!==e.id));return t.map(Hs)},qs=({hasFailed:e,isLoading:s,multi:t,options:n})=>e?Object(i.jsx)(l.a,{message:"ui-business-units-lib.options.error.title"}):s?Object(i.jsx)(l.a,{message:"ui-business-units-lib.options.loading"}):0===n.length?Object(i.jsx)(l.a,{message:"ui-business-units-lib.placeholders.selectBusinessUnits.none"}):Object(i.jsx)(l.a,{message:"ui-business-units-lib.placeholders.selectBusinessUnits",options:{count:t?2:1}}),Vs={multi:!1,withHeader:!1,includeViewAll:!1,includeAccountBusinessUnit:!0,readOnly:!1,isLoading:!1,hasFailed:!1,disabled:!1,showFooter:!0},Qs=({onChange:e,buOptions:s=[],buId:t,buIds:n,buttonUse:a,multi:r,withHeader:o,includeViewAll:c,className:u,includeAccountBusinessUnit:b,menuWidth:d,readOnly:p,isLoading:S,hasFailed:h,disabled:j,placement:m,ButtonContent:E,showFooter:g})=>{const[C,f]=Object(T.useState)([]),[x,I]=Object(T.useState)([]),[_,R]=Object(T.useState)(0),N=vs(x),P=Ls(C),y=Gs(C),M=!N||N&&P;Object(T.useEffect)(()=>{Ds()().then(e=>{f(e.user.scopes);I(e.gates);R(e.portal.portal_id)}).catch(e=>console.error(e))},[]);const D=Ks(s,b);c&&M&&D.unshift({value:Bs.a,text:O.a.text("ui-business-units-lib.labels.allBusinessUnits")});const B=({currentTarget:{value:s}})=>{c&&s===Bs.a?e(void 0):e(s)},v=ks({formattedOptions:D}),L=Ws({multi:r,buId:t,buIds:n,includeViewAll:c,canViewAll:M,formattedOptions:D,isBusinessUnitOneOption:v,isLoading:S,hasFailed:h});return Object(i.jsxs)(i.Fragment,{children:[o&&Object(i.jsx)(ys.a,{children:Object(i.jsx)(l.a,{message:"ui-business-units-lib.labels.businessUnit"})}),Object(i.jsx)(A.a,{error:h,validationMessage:h&&Object(i.jsx)(l.a,{message:"ui-business-units-lib.options.error.message"}),children:Object(i.jsx)(U.a,{"data-test-id":"business-unit-select",options:D,onChange:B,value:L,buttonUse:a,multi:r,placeholder:Object(i.jsx)(qs,{hasFailed:h,isLoading:S,multi:r,options:D}),menuWidth:d,className:u,readOnly:v||p,isLoading:S,error:h,disabled:j,placement:m,ButtonContent:E,anchorType:r?"button":void 0,dropdownFooter:g&&y&&Object(i.jsx)(Q.a,{external:!0,href:`/settings/${_}/business-units`,children:Object(i.jsx)(l.a,{message:"ui-business-units-lib.footer.manageBUs"})})})})]})};Qs.defaultProps=Vs;Qs.propTypes={buOptions:p.a.array,buId:p.a.number,buIds:p.a.array,onChange:p.a.func.isRequired,buttonUse:p.a.oneOf(["transparent","form-on-dark"]),multi:p.a.bool,withHeader:p.a.bool,includeViewAll:p.a.bool,className:p.a.string,includeAccountBusinessUnit:p.a.bool,menuWidth:p.a.oneOfType([p.a.number,p.a.oneOf(["auto"])]),readOnly:p.a.bool,isLoading:p.a.bool,hasFailed:p.a.bool,disabled:p.a.bool,placement:p.a.oneOf(["left","right","top","bottom","left top","left bottom","right top","right bottom","top left","top right","bottom left","bottom right"]),ButtonContent:p.a.elementType,showFooter:p.a.bool};var Ys=Qs,$s=t("pEX8"),zs=t("jtRn"),Js=t("frTi"),Zs=t("++X+");let Xs;var et=(e=Xs,s,t)=>{const[i,n]=Object(T.useState)([]);Object(T.useEffect)(()=>{const i=e=>{Xs=e;n(e)};let a=!1;const r=s.includes("campaign-business-unit"),o=t.includes("business-units-access");r&&o&&(a=!0);e?i(e):a?M.a.get("business-units/v1/business-unit-displays/user/dropdown").then(e=>i(e)):i([{id:0,name:"",hubId:0}])},[e,s,t]);return i};var st=({appName:e})=>{Ps.track("subscriptionsHistoryTabOpened",{appName:e})},tt=t("yIhL");const it=({options:e,queryParams:s,contactVid:t,startTimestamp:i,maxRows:n})=>{const a=Object.assign({startTimestamp:i,maxRows:n},s),r=fs(a);return M.a.get(`subscriptions/v1/timeline/contact/${t}${r}`,Object.assign({},Ge,{},e))};var nt=e=>{const[s,t]=Object(T.useState)([]);Object(T.useEffect)(()=>{it({contactVid:e}).then(t)},[e]);return s};const at={channel:"channel",subscription:"subscription",newStatus:"newStatus",contactInfo:"contactInfo",legalBasis:"legalBasis",explanation:"explanation",requestedBy:"requestedBy",source:"source",created:"created"};var rt=()=>Object(i.jsx)("tr",{children:Object.keys(at).map(e=>Object(i.jsx)("th",{style:{minWidth:"170px"},"data-test-id":"subscriptions-history-table-column",children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsHistory.columns."+e})},e))}),ot=t("uMkL");const ct={[cs.EMAIL]:"email",[cs.WHATSAPP]:"whatsApp",[cs.SMS]:"sms"};var ut=({event:e})=>{const{optState:s,legalBasisExplanation:t,requestedByEmail:n,timestamp:a,legalBasis:r,subscriptionChangeSource:o,portalWide:c,businessUnitWide:u,brandWide:b,brandName:d,subscriptionName:p}=e.timelineResponse,O={[at.channel]:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable."+ct[e.subscriberType]}),[at.newStatus]:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsHistory.status."+s}),[at.contactInfo]:e.subscriberType===Ye.SMS?Object(i.jsx)(xe.a,{title:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsHistory.tooltips.contactInfo"}),children:Object(i.jsx)("span",{children:e.subscriberIdString})}):e.subscriberIdString,[at.explanation]:t,[at.requestedBy]:n,[at.created]:Object(i.jsx)(ot.a,{value:a||new Date,format:"LLLL"}),[at.subscription]:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsHistory.unknown"})};r&&(O[at.legalBasis]=Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsHistory.legalBasis."+r}));o&&(O[at.source]=Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsHistory.sources."+o}));c?O[at.subscription]=Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsHistory.historyEvent.portalWide"}):u?O[at.subscription]=Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsHistory.historyEvent.businessUnitWide"}):b?O[at.subscription]=d:p&&(O[at.subscription]=p);return Object(i.jsx)("tr",{"data-test-id":"subscriptions-history-table-row",children:Object.keys(at).map(e=>Object(i.jsx)("td",{className:O[e]?"":"text-center",children:O[e]||"-"},e))})};var lt=({events:e})=>{const s=Object.keys(at).length;return e.length<=0?Object(i.jsx)("tr",{height:200,className:"text-center",children:Object(i.jsx)("td",{colSpan:s,children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsHistory.historyEvent.noHistory"})})}):Object(i.jsx)(i.Fragment,{children:e.map(e=>{const{subscriptionId:s,timestamp:t}=e.timelineResponse,n=s?t+s:"_"+Math.random().toString(36).substr(2,9);return Object(i.jsx)(ut,{event:e},n)})})};var bt=({appName:e,contactId:s,pageCount:t=15,currentBusinessUnit:n,channelStatus:a})=>{const[r,o]=Object(T.useState)(1),c=nt(s),u=({target:{value:e}})=>o(e),l=Object(T.useMemo)(()=>c.filter(e=>e.timelineResponse.businessUnitId===n.id).filter(e=>{switch(e.subscriberType){case Ye.WHATSAPP:return a.WHATSAPP;case Ye.SMS:return a.SMS;default:return!0}}),[c,n.id,a.SMS,a.WHATSAPP]),b=l.slice((r-1)*t,r*t),d=l.length>=t||r>1;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)(Ee.a,{children:[Object(i.jsx)("thead",{children:Object(i.jsx)(rt,{})}),Object(i.jsx)("tbody",{children:Object(i.jsx)(lt,{events:b})})]}),d&&Object(i.jsx)(tt.a,{"data-test-id":"ui-paginator",pageCount:Math.ceil(l.length/t),page:r,onPageChange:u})]})},dt=t("DwG8"),pt=t.n(dt);const Ot=({options:e,data:s,queryParams:t,subscriberType:i,subscriberIdString:n})=>{const a=fs(t);return M.a.post(`subscriptions/v1/status/${i}/${n}${a}`,Object.assign({},Ge,{},e,{data:s}))};var St=(e,s,t)=>{const i={subscriberType:e.channel,subscriberIdString:e.subscriberIdString,data:[{optState:ke.OPT_OUT,subscriptionChangeSource:We.SOURCE_HUBSPOT_CUSTOMER,source:"SUBSCRIPTION_STATUS_TABLE_UNSUBSCRIBE_BUTTON",sourceType:qe.API,updateCause:we.UPDATED_VIA_HUBSPOT_CUSTOMER,portalId:V.a.get(),subscriptionId:e.id,timestamp:(new Date).getTime()}]};return Ot(i).then(()=>s(i,e)).catch(s=>t(s,i,e))};var ht=({appName:e})=>{Ps.track("subscriptionStatusTableUnsubscribe",{appName:e})};const jt=({options:e,queryParams:s,subscriberType:t,subscriberIdString:i,subscriptionId:n,legalBasis:a,legalBasisExplanation:r})=>{const o=Object.assign({subscriptionId:n,legalBasis:a,legalBasisExplanation:r},s),c=fs(o);return M.a.post(`subscriptions/v1/resubscription/${t}/${i}${c}`,Object.assign({},Ge,{},e))};var mt=(e,s,t,i,n)=>{const a={subscriberType:e.channel,subscriberIdString:e.subscriberIdString,subscriptionId:e.id,legalBasis:s,legalBasisExplanation:t};return jt(a).then(()=>i(a,e)).catch(s=>n(s,a,e))};var Tt=({appName:e,legalBasis:s})=>{Ps.track("subscriptionStatusTableResubscribe",{appName:e,legalBasis:s})};var Et=({appName:e,legalBasis:s})=>{Ps.track("subscriptionStatusTableSubscribe",{appName:e,legalBasis:s})};var gt=({value:e,onChange:s,validationState:t})=>{const[n,a]=t,r=null!==a;return Object(i.jsx)(A.a,{required:!0,label:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscribeModal.explanationInput.label"}),error:!n&&r,validationMessage:r?Object(i.jsx)(l.a,{"data-test-id":"explanation-input-error-message",message:a}):null,children:Object(i.jsx)(te.a,{"data-test-id":"subscribe-modal-explanation-input",placeholder:O.a.text("subscriptionsComponents.subscribeModal.explanationInput.placeholder"),onChange:s,value:e})})},Ct=t("w3lB");const ft=({hideConsent:e=!1,hideContract:s=!1,showHelpText:t=!1,hideNonGdpr:i=!1})=>{const n=[Object.assign({text:O.a.text("options.legalBasis."+Ct.c.LEGITIMATE_INTEREST_PQL),value:Ct.c.LEGITIMATE_INTEREST_PQL},t&&{help:O.a.text("options.legalBasis.help."+Ct.c.LEGITIMATE_INTEREST_PQL)}),Object.assign({text:O.a.text("options.legalBasis."+Ct.c.LEGITIMATE_INTEREST_CLIENT),value:Ct.c.LEGITIMATE_INTEREST_CLIENT},t&&{help:O.a.text("options.legalBasis.help."+Ct.c.LEGITIMATE_INTEREST_CLIENT)}),Object.assign({text:O.a.text("options.legalBasis."+Ct.c.LEGITIMATE_INTEREST_OTHER),value:Ct.c.LEGITIMATE_INTEREST_OTHER},t&&{help:O.a.text("options.legalBasis.help."+Ct.c.LEGITIMATE_INTEREST_OTHER)})];s||n.push(Object.assign({text:O.a.text("options.legalBasis."+Ct.c.PERFORMANCE_OF_CONTRACT),value:Ct.c.PERFORMANCE_OF_CONTRACT},t&&{help:O.a.text("options.legalBasis.help."+Ct.c.PERFORMANCE_OF_CONTRACT)}));e||n.push(Object.assign({text:O.a.text("options.legalBasis."+Ct.c.CONSENT_WITH_NOTICE),value:Ct.c.CONSENT_WITH_NOTICE},t&&{help:O.a.text("options.legalBasis.help."+Ct.c.CONSENT_WITH_NOTICE)}));i||n.push(Object.assign({text:O.a.text("options.legalBasis."+Ct.c.NON_GDPR),value:Ct.c.NON_GDPR},t&&{help:O.a.text("options.legalBasis.help."+Ct.c.NON_GDPR)}));return n};var xt=e=>Object(i.jsx)(A.a,Object.assign({label:O.a.text("labels.legalBasis")},e.formControlProps,{children:Object(i.jsx)(U.a,Object.assign({placeholder:O.a.text("placeholders.legalBasis")},e,{options:ft(e),dropdownClassName:"untruncate","data-selenium-test":"gdpr-legal-basis-select"}))}));var It=({onChange:e,isWhatsapp:s,validationState:t})=>{const[n,a]=t,r=null!==a;return Object(i.jsx)(xt,{"data-test-id":"subscribe-modal-legal-basis-select",hideNonGdpr:s,formControlProps:{label:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscribeModal.legalBasisSelect.label"}),required:!0,error:!n&&r,validationMessage:r?Object(i.jsx)(l.a,{"data-test-id":"legal-basis-error-message",message:a}):null},onChange:e})};const _t=e=>void 0===e?[!1,null]:[!0,null],Rt=e=>void 0===e?[!1,null]:""===e?[!1,"subscriptionsComponents.subscribeModal.explanationInput.validationError.explanationRequired"]:[!0,null];var Nt=({legalBasis:e,explanation:s})=>{const t=_t(e),i=Rt(s);return{formValid:t[0]&&i[0],legalBasisValid:t,explanationValid:i}};var At=({appName:e,isOpen:s,email:t,optState:n,status:a,onClose:r,onSubmit:o,handleSubscribeSuccess:c=(()=>{}),handleSubscribeError:u=(()=>{}),initialLegalBasis:b,initialExplanation:d})=>{const p=a.channel===cs.WHATSAPP,[O,S]=Object(T.useState)(b),[h,j]=Object(T.useState)(d),m=Nt({legalBasis:O,explanation:h}),E=n===ke.NOT_OPTED?"Subscribe":"Resubscribe";if(!s)return Object(i.jsx)(i.Fragment,{});const g=()=>{S(void 0);j(void 0)},C=()=>{r&&r();g()},f=()=>{mt(a,O,h,(s,t)=>{c(s,t);"Subscribe"===E?Et({appName:e,legalBasis:s.legalBasis}):"Resubscribe"===E&&Tt({appName:e,legalBasis:s.legalBasis})},u);o&&o({legalBasis:O,explanation:h});g()};return Object(i.jsxs)(he.a,{"data-test-id":"subscribe-modal",use:"success",width:"35%",children:[Object(i.jsxs)(Te.a,{children:[Object(i.jsx)(Ie.a,{children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscribeModal.modalHeader"+E})}),Object(i.jsx)(pe.a,{"data-test-id":"subscribe-modal-close-button",onClick:C})]}),Object(i.jsxs)(je.a,{children:[Object(i.jsx)(ve.a,{message:"subscriptionsComponents.subscribeModal.bodyText"+E,options:{email:t}}),Object(i.jsxs)(se.a,{children:[Object(i.jsx)(It,{onChange:e=>S(e.target.value),isWhatsapp:p,validationState:m.legalBasisValid}),Object(i.jsx)(gt,{value:h,onChange:e=>j(e.target.value),validationState:m.explanationValid})]})]}),Object(i.jsxs)(me.a,{children:[Object(i.jsx)(de.a,{"data-test-id":"subscribe-modal-save-button",disabled:!m.formValid,onClick:f,use:"primary",children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscribeModal.saveButton"})}),Object(i.jsx)(de.a,{onClick:C,children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscribeModal.cancelButton"})})]})]})},Pt=t("EIJv"),Ut=t("GTTy"),yt=t("+KD7");const Mt=()=>Object(i.jsx)(Q.a,{href:"https://knowledge.hubspot.com/contacts/how-do-subscription-preferences-and-types-work",children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable.status.info.learnMore"})}),Dt=()=>Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(Ut.a,{use:"success"}),Object(i.jsx)(l.a,{"data-test-id":"subscription-status-table-subscribed-icon-message",message:"subscriptionsComponents.subscriptionsStatusTable.status.subscribed"})]}),Bt=()=>Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(Ut.a,{use:"danger"}),Object(i.jsx)(l.a,{"data-test-id":"subscription-status-table-unsubscribed-icon-message",message:"subscriptionsComponents.subscriptionsStatusTable.status.unsubscribed"})]}),vt=()=>Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(Ut.a,{use:"default"}),Object(i.jsx)(l.a,{"data-test-id":"subscription-status-table-not-specified-gdpr-enabled-icon-message",message:"subscriptionsComponents.subscriptionsStatusTable.status.notSpecified"})," ",Object(i.jsx)(xe.a,{title:Object(i.jsx)(ve.a,{message:"subscriptionsComponents.subscriptionsStatusTable.status.info.gdprEnabledTooltip",options:{learnMore:Object(i.jsx)(Mt,{})}}),children:Object(i.jsx)(Oe.a,{name:"info"})})]}),Lt=()=>Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(Ut.a,{use:"default"}),Object(i.jsx)(l.a,{"data-test-id":"subscription-status-table-not-specified-gdpr-enforced-icon-message",message:"subscriptionsComponents.subscriptionsStatusTable.status.notSpecified"})," ",Object(i.jsx)(xe.a,{title:Object(i.jsx)(ve.a,{message:"subscriptionsComponents.subscriptionsStatusTable.status.info.gdprEnforcedTooltip",options:{learnMore:Object(i.jsx)(Mt,{})}}),children:Object(i.jsx)(Oe.a,{name:"info",color:yt.EERIE})})]}),Gt=()=>Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(Ut.a,{use:"default"}),Object(i.jsx)(l.a,{"data-test-id":"subscription-status-table-whatsapp-icon-message",message:"subscriptionsComponents.subscriptionsStatusTable.status.notSpecified"})," ",Object(i.jsx)(xe.a,{title:Object(i.jsx)(ve.a,{message:"subscriptionsComponents.subscriptionsStatusTable.status.info.whatsAppTooltip",options:{learnMore:Object(i.jsx)(Mt,{})}}),children:Object(i.jsx)(Oe.a,{role:"tooltip",name:"info",color:yt.EERIE})})]}),wt=()=>Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(Ut.a,{use:"default"}),Object(i.jsx)(l.a,{"data-test-id":"subscription-status-table-sms-icon-message",message:"subscriptionsComponents.subscriptionsStatusTable.status.notSpecified"})," ",Object(i.jsx)(xe.a,{role:"ui-tooltip",title:Object(i.jsx)(ve.a,{message:"subscriptionsComponents.subscriptionsStatusTable.status.info.smsTooltip",options:{learnMore:Object(i.jsx)(Mt,{})}}),children:Object(i.jsx)(Oe.a,{role:"tooltip",name:"info",color:yt.EERIE})})]});var Ft=({optState:e,GdprToggleEnabled:s,LegalBasisRequirementEnabled:t,subChannel:n})=>e===ke.OPT_IN||e===ke.DOUBLE_OPT_IN?Object(i.jsx)(Dt,{}):e===ke.OPT_OUT?Object(i.jsx)(Bt,{}):n===cs.WHATSAPP?Object(i.jsx)(Gt,{}):n===cs.SMS?Object(i.jsx)(wt,{}):s&&!t?Object(i.jsx)(vt,{}):t?Object(i.jsx)(Lt,{}):Object(i.jsx)(vt,{});var Ht=({status:e,GdprToggleEnabled:s,LegalBasisRequirementEnabled:t,hasMultipleSubscriberIds:n,onClickUnsubscribe:a=(()=>{}),onClickSubscribe:r=(()=>{})})=>{const o=e.optState===ke.OPT_IN||e.optState===ke.DOUBLE_OPT_IN,c=e.optState===ke.OPT_OUT,u=c?"resubscribeButton":"subscribeButton",b=Object(T.useCallback)(()=>{let s;switch(e.channel){case cs.WHATSAPP:s="whatsApp";break;case cs.SMS:s="sms";break;default:s="email"}return Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable."+s})},[e]),d=()=>{c||a()},p=()=>{o||r()},O=e=>Object(i.jsx)(de.a,{"data-test-id":"subscriptions-status-table-row-subscribe-button",disabled:e,use:"tertiary-light",onClick:p,children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable."+u})}),S=()=>{let s;s=e.channel===cs.SMS&&e.updateCause===we.UPDATED_BY_SUBSCRIBER?Object(i.jsx)(xe.a,{title:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable.reSubscribeTooltip"}),children:O(!0)}):O(o);return s};return Object(i.jsxs)("tr",{"data-test-id":"subscriptions-status-table-row",children:[Object(i.jsx)("td",{"data-test-id":"subscriptions-status-table-channel",children:b()}),Object(i.jsx)(ge.a,{hoverContent:Object(i.jsxs)(i.Fragment,{children:[!c&&Object(i.jsx)(de.a,{"data-test-id":"subscriptions-status-table-row-unsubscribe-button",use:"tertiary-light",onClick:d,children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable.unsubscribeButton"})}),!o&&S()]}),children:Object(i.jsx)(Pt.a,{children:e.name||""})}),Object(i.jsx)("td",{children:Object(i.jsx)(Ft,{optState:e.optState,GdprToggleEnabled:s,LegalBasisRequirementEnabled:t,subChannel:e.channel})}),n?Object(i.jsx)("td",{children:Object(i.jsx)(Pt.a,{children:e.subscriberIdString})}):Object(i.jsx)(i.Fragment,{})]})};const kt=()=>{const[e,s]=Object(T.useState)(!1),[t,i]=Object(T.useState)(""),[n,a]=Object(T.useState)(ke.NOT_OPTED),[r,o]=Object(T.useState)({});return[{open:e,email:t,optState:n,status:r},({newOpen:e,newEmail:t,newOptState:n,newStatus:r})=>{void 0!==e&&s(e);void 0!==t&&i(t);void 0!==n&&a(n);void 0!==r&&o(r)}]};var Wt=({appName:e,statuses:s,dataPrivacySettings:t,handleSubscribeSuccess:n=(()=>{}),handleSubscribeError:a=(()=>{}),handleUnsubscribeSuccess:r=(()=>{}),handleUnsubscribeError:o=(()=>{})})=>{const[c,u]=kt(),b=Object(T.useMemo)(()=>!!t&&t.gdprToggleEnabled,[t]),d=Object(T.useMemo)(()=>!!t&&t.legalBasisRequirementEnabled,[t]),p=Object(T.useMemo)(()=>pt()(s.filter(e=>e.channel===cs.EMAIL).map(e=>e.subscriberIdString)),[s]),O=Object(T.useMemo)(()=>pt()(s.filter(e=>e.channel===cs.SMS||e.channel===cs.WHATSAPP).map(e=>e.subscriberIdString)),[s]),S=()=>{u({newOpen:!1,newEmail:"",newOptState:ke.NOT_OPTED,newStatus:{}})},h=e=>{u({newOpen:!0,newEmail:e.subscriberIdString,newOptState:e.optState,newStatus:e})},j=s=>{St(s,(s,t)=>{r(s,t);ht({appName:e})},o)},m=p.length>1||O.length>1;return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(At,{appName:e,isOpen:c.open,onClose:S,onSubmit:S,email:c.email,optState:c.optState,status:c.status,handleSubscribeSuccess:n,handleSubscribeError:a}),Object(i.jsxs)(Ee.a,{children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{style:{width:"15%"},children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable.channel"})}),Object(i.jsx)("th",{style:{width:m?"40%":"45%"},children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable.subscriptionTypeHeader"})}),Object(i.jsx)("th",{style:{width:m?"20%":"40%"},children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable.statusHeader"})}),m&&Object(i.jsx)("th",{style:{width:m?"25%":"0%"},"data-test-id":"subscription-status-table-contact-info-col-header",children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusTable.contactInfoHeader"})})]})}),Object(i.jsx)("tbody",{children:s.map(e=>Object(i.jsx)(Ht,{status:e,GdprToggleEnabled:b,LegalBasisRequirementEnabled:d,hasMultipleSubscriberIds:m,onClickUnsubscribe:()=>j(e),onClickSubscribe:()=>h(e)},`${e.name}-${e.subscriberIdString}`))})]})]})};const Kt=(e,s=!1)=>e?e.subsCardStatuses.filter(e=>!s||e.defaultSubscription===ze.ONE_TO_ONE):[],qt=(e,s,t,i)=>{const n=[];if(e)if(i){const t=e.find(e=>e.businessUnitId===s.id);t&&Vt(n,t)}else e.forEach(e=>{Vt(n,e)});return n.filter(e=>{switch(e.channel){case cs.WHATSAPP:return t.WHATSAPP;case cs.SMS:return t.SMS;default:return t.EMAIL}})};function Vt(e,s){if(s){const{emailStatuses:t,whatsAppStatuses:i,secondaryEmailStatuses:n,smsMobilePhoneStatuses:a,smsPhoneStatuses:r}=s;t&&e.push(...Kt(t));i&&e.push(...Kt(i));n&&n.forEach(s=>{e.push(...Kt(s,!0))});a&&e.push(...Kt(a));r&&e.push(...Kt(r))}}var Qt=({appName:e,contactId:s,initDataPrivacySettings:t,currentBusinessUnit:n,channelStatus:a,hasBusinessUnits:r,handleSubscribeSuccess:o=(()=>{}),handleSubscribeError:c=(()=>{}),handleUnsubscribeSuccess:u=(()=>{}),handleUnsubscribeError:l=(()=>{})})=>{const b=Is(s),[d,p]=Object(T.useState)([]),O=Cs(t);Object(T.useMemo)(()=>p(qt(b,n,a,r)),[b,n,a,r]);const S=(e,s,t)=>{p(d.map(i=>i.id!==e||i.subscriberIdString!==s?i:Object.assign({},i,{updateCause:we.UPDATED_VIA_HUBSPOT_CUSTOMER,optState:t})))};return Object(i.jsx)(Wt,{appName:e,statuses:d,dataPrivacySettings:O,handleSubscribeSuccess:(e,s)=>{o(e,s);S(s.id,s.subscriberIdString,ke.OPT_IN)},handleSubscribeError:c,handleUnsubscribeSuccess:(e,s)=>{u(e,s);S(s.id,s.subscriberIdString,ke.OPT_OUT)},handleUnsubscribeError:l})};const Yt=Object($s.a)(Ys);var $t;!function(e){e.SUBSCRIPTIONS="1";e.HISTORY="2"}($t||($t={}));const zt={id:0,name:"",hubId:0};var Jt=({appName:e,isOpen:s,contactId:t,gates:n,scopes:a,initDataPrivacySettings:r,channelStatus:o,onClose:c,handleSubscribeSuccess:u,handleSubscribeError:b,handleUnsubscribeSuccess:d,handleUnsubscribeError:p})=>{const O=Cs(r),S=et(void 0,n,a),h=n.includes("campaign-business-unit"),j=a.includes("business-units-access"),m=h&&j,[E,g]=Object(T.useState)(zt),C=S.length>1;Object(T.useMemo)(()=>{g(S.find(e=>0===e.id)||zt)},[S]);if(!s)return Object(i.jsx)(i.Fragment,{});const f=()=>{c&&c()},x=e=>g(S.find(s=>s.id===e)||zt),I=s=>{s.target.value===$t.HISTORY&&st({appName:e})};return Object(i.jsxs)(Se.a,{"data-test-id":"subscription-status-panel",width:"65%",children:[Object(i.jsxs)(Te.a,{children:[Object(i.jsx)(zs.a,{children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusPanel.header"})}),Object(i.jsx)(pe.a,{"data-test-id":"subscriptions-status-panel-close-button",onClick:f})]}),Object(i.jsxs)(je.a,{"data-test-id":"subscription-status-panel-body",children:[C&&Object(i.jsx)(A.a,{"data-test-id":"subscription-status-panel-business-unit-selector",label:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusPanel.businessUnitLabel"}),children:Object(i.jsx)(Yt,{onChange:x,buId:E?E.id:void 0})}),Object(i.jsxs)(Zs.a,{defaultSelected:$t.SUBSCRIPTIONS,onSelectedChange:I,children:[Object(i.jsx)(Js.a,{tabId:$t.SUBSCRIPTIONS,title:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusPanel.tabs.subscriptions"}),children:Object(i.jsx)(Qt,{appName:e,contactId:t,hasBusinessUnits:m,currentBusinessUnit:E,channelStatus:o,initDataPrivacySettings:O,handleSubscribeSuccess:(...e)=>{u&&u(...e)},handleSubscribeError:(...e)=>{b&&b(...e)},handleUnsubscribeSuccess:(...e)=>{d&&d(...e)},handleUnsubscribeError:(...e)=>{p&&p(...e)}})}),Object(i.jsx)(Js.a,{tabId:$t.HISTORY,title:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsStatusPanel.tabs.history"}),children:Object(i.jsx)(bt,{appName:e,contactId:t,currentBusinessUnit:E,channelStatus:o})})]})]})]})},Zt=t("dPcB");const Xt="card-status-indicator-email-only",ei=e=>{let s=0,t=0,i=!0,n=!0,a=!1;Object.values(e).forEach(e=>{if(!e.emailStatuses)return;const{subsCardStatuses:r}=e.emailStatuses;if(!(r.length<=0)){t+=r.length;if(e.optState!==ke.OPT_OUT){n=!1;r.forEach(e=>{e.optState!==ke.OPT_OUT&&(n=!1);e.optState!==ke.NOT_OPTED&&(i=!1);if(e.optState===ke.OPT_IN||e.optState===ke.DOUBLE_OPT_IN){s+=1;e.defaultSubscription===ze.ONE_TO_ONE&&(a=!0)}})}else i=!1}});return i?{dataTestId:Xt+"-all-not-opted",key:"subscriptionsComponents.subscriptionsContactCard.cardStatusText.emailOnly.allNotOpted",icon:"default",messageOptions:{}}:n?{dataTestId:Xt+"-all-opted-out",key:"subscriptionsComponents.subscriptionsContactCard.cardStatusText.emailOnly.allOptedOut",icon:"danger",messageOptions:{}}:s>=t?{dataTestId:Xt+"-subscribed-to-all",key:"subscriptionsComponents.subscriptionsContactCard.cardStatusText.emailOnly.subscribedToAll",icon:"success",messageOptions:{}}:s<t?a?{dataTestId:Xt+"-subscribed-to-some-include-one-to-one",key:"subscriptionsComponents.subscriptionsContactCard.cardStatusText.emailOnly.subscribedToSomeIncludeOneToOne",icon:"success",messageOptions:{subscribedCount:s,subscriptionsTotal:t}}:{dataTestId:Xt+"-subscribed-to-some-not-one-to-one",key:"subscriptionsComponents.subscriptionsContactCard.cardStatusText.emailOnly.subscribedToSomeNotOneToOne",icon:"success",messageOptions:{subscribedCount:s,subscriptionsTotal:t}}:void 0};var si=t("Qj0O"),ti=t.n(si);const ii="card-status-indicator-multi-channel";var ni;!function(e){e.OPTED_IN_TO_ANY_STATUS="OPTED_IN_TO_ANY_STATUS";e.OPTED_OUT_OF_ALL_STATUSES="OPTED_OUT_OF_ALL_STATUSES";e.NOT_OPTED_TO_ALL_STATUSES="NOT_OPTED_TO_ALL_STATUSES"}(ni||(ni={}));const ai=e=>Object.values(e).filter(Boolean).length>1,ri=e=>{if(!e)return ni.NOT_OPTED_TO_ALL_STATUSES;let s=!1,t=!1,i=0;for(;!1===s&&i<e.subsCardStatuses.length;){const n=e.subsCardStatuses[i];n.optState===ke.OPT_IN||n.optState===ke.DOUBLE_OPT_IN?s=!0:n.optState===ke.OPT_OUT&&(t=!0);i+=1}return s?ni.OPTED_IN_TO_ANY_STATUS:t?ni.OPTED_OUT_OF_ALL_STATUSES:ni.NOT_OPTED_TO_ALL_STATUSES},oi=e=>{const s=(e,s)=>e===ni.NOT_OPTED_TO_ALL_STATUSES?s:e===ni.OPTED_OUT_OF_ALL_STATUSES&&s===ni.OPTED_IN_TO_ANY_STATUS?ni.OPTED_IN_TO_ANY_STATUS:e;return e.reduce((e,t)=>({subscribedToEmailState:s(e.subscribedToEmailState,t.subscribedToEmailState),subscribedToWhatsAppState:s(e.subscribedToWhatsAppState,t.subscribedToWhatsAppState),subscribedToMobilePhoneSMSState:s(e.subscribedToMobilePhoneSMSState,t.subscribedToMobilePhoneSMSState),subscribedToPhoneSMSState:s(e.subscribedToPhoneSMSState,t.subscribedToPhoneSMSState)}),{subscribedToEmailState:ni.NOT_OPTED_TO_ALL_STATUSES,subscribedToWhatsAppState:ni.NOT_OPTED_TO_ALL_STATUSES,subscribedToPhoneSMSState:ni.NOT_OPTED_TO_ALL_STATUSES,subscribedToMobilePhoneSMSState:ni.NOT_OPTED_TO_ALL_STATUSES})},ci=(e,s)=>{const t=e.map(e=>{let s,t,i,n;if(e.optState===ke.OPT_OUT){s=ni.OPTED_OUT_OF_ALL_STATUSES;t=ni.OPTED_OUT_OF_ALL_STATUSES;i=ni.OPTED_OUT_OF_ALL_STATUSES;n=ni.OPTED_OUT_OF_ALL_STATUSES}else{t=ri(e.whatsAppStatuses);s=ri(e.emailStatuses);i=ri(e.smsPhoneStatuses);n=ri(e.smsMobilePhoneStatuses)}return{subscribedToEmailState:s,subscribedToWhatsAppState:t,subscribedToPhoneSMSState:i,subscribedToMobilePhoneSMSState:n}}),{subscribedToEmailState:i,subscribedToWhatsAppState:n,subscribedToPhoneSMSState:a,subscribedToMobilePhoneSMSState:r}=oi(t),o=[{displayKey:"Email",status:i}];s.SMS&&o.push({displayKey:"SMS",status:r},{displayKey:"SMS",status:a});s.WHATSAPP&&o.push({displayKey:"WhatsApp",status:n});ti()(o,e=>e.displayKey);const c=e=>`${ii}-${e.toLowerCase()}`,u=[];o.forEach(e=>{e.status!==ni.OPTED_IN_TO_ANY_STATUS||u.includes(e.displayKey)||u.push(e.displayKey)});if(u.length===Object.keys(cs).length)return{dataTestId:c(ke.OPT_IN),key:"subscriptionsComponents.subscriptionsContactCard.cardStatusText.multiChannel.subscribedToAll",icon:"success",messageOptions:{}};if(u.length>0)return{dataTestId:c(ke.OPT_IN),key:"subscriptionsComponents.subscriptionsContactCard.cardStatusText.multiChannel.subscribedTo"+u.join("_"),icon:"success",messageOptions:{}};return o.every(e=>e.status===ni.NOT_OPTED_TO_ALL_STATUSES)?{dataTestId:c(ke.NOT_OPTED),key:"subscriptionsComponents.subscriptionsContactCard.cardStatusText.multiChannel.allNotOped",icon:"default",messageOptions:{}}:{dataTestId:c(ke.OPT_OUT),key:"subscriptionsComponents.subscriptionsContactCard.cardStatusText.multiChannel.allOptedOut",icon:"danger",messageOptions:{}}};var ui=({channelStatus:e,firstName:s,lastName:t,fallbackForMissingName:n,subscriptionStatuses:a})=>{const r=Object(Zt.a)({firstName:s,lastName:t,email:n}),o=Object(T.useMemo)(()=>{let s;s=ai(e)?ci(a,e):ei(a);return s},[a,e]);return void 0===o?Object(i.jsx)(i.Fragment,{}):Object(i.jsxs)("p",{"data-test-id":o.dataTestId,children:[Object(i.jsx)(Ut.a,{use:o.icon}),Object(i.jsx)(ve.a,{message:o.key,options:Object.assign({},o.messageOptions,{formattedName:r})})]})};var li=({appName:e,contactId:s,gates:t,scopes:n,firstName:a,lastName:r,initDataPrivacySettings:o,onStatusPanelOpen:c,onStatusPanelClose:u,handleSubscribeSuccess:b,handleSubscribeError:d,handleUnsubscribeSuccess:p,handleUnsubscribeError:O})=>{const S=Es(t,n),h=Cs(o),j=Is(s),[m,E]=Object(T.useState)(!1),g=Object(T.useMemo)(()=>{if(j){const e=j[0],{emailStatuses:s,whatsAppStatuses:t}=e;if(s&&s.subsCardStatuses&&s.subsCardStatuses[0])return s.subsCardStatuses[0].subscriberIdString;if(t&&t.subsCardStatuses&&t.subsCardStatuses[0])return t.subsCardStatuses[0].subscriberIdString}},[j]),C=()=>{c&&c();Us({appName:e});E(!0)},f=()=>{u&&u();E(!1)};return Object(i.jsxs)(i.Fragment,{children:[j&&Object(i.jsx)(ui,{channelStatus:S,firstName:a,lastName:r,fallbackForMissingName:g,subscriptionStatuses:j}),Object(i.jsx)(de.a,{"data-test-id":"subscriptions-contact-card-view-subs-link",use:"link",onClick:C,children:Object(i.jsx)(l.a,{message:"subscriptionsComponents.subscriptionsContactCard.openPanelButton"})}),Object(i.jsx)(Jt,{appName:e,isOpen:m,channelStatus:S,contactId:s,gates:t,scopes:n,onClose:f,initDataPrivacySettings:h,handleSubscribeSuccess:b,handleSubscribeError:d,handleUnsubscribeSuccess:p,handleUnsubscribeError:O})]})},bi=t("7ETf"),di=t.n(bi),pi=t("WRZ8"),Oi=t("FeM/"),Si=t("frTQ"),hi=t("lkf3");const ji=e=>{const s=e.map(e=>G(e)),t=v(),i=B();return Promise.all([i,t,...s])};var mi=()=>Object(i.jsx)("tr",{children:Object.keys(Ct.a).map(e=>Object(i.jsx)("th",{style:{minWidth:"170px"},children:Object(i.jsx)(l.a,{message:"events.headers."+e})},e))}),Ti=t("xUVM");var Ei=({event:e,subscriptionTypes:s,brands:t})=>{const n={[Ct.a.newStatus]:Object(i.jsx)(l.a,{message:"events.status."+e.optState}),[Ct.a.email]:e.recipientEmail,[Ct.a.explanation]:e.legalBasisExplanation,[Ct.a.requestedBy]:e.requestedBy,[Ct.a.created]:Object(i.jsx)(ot.a,{value:e.timestamp||new Date,format:"LLL"}),[Ct.a.subscription]:Object(i.jsx)(l.a,{message:"unknown"})};e.legalBasis&&(n[Ct.a.legalBasis]=Object(i.jsx)(l.a,{message:"options.legalBasis."+e.legalBasis}));e.subscriptionChangeSource&&(n[Ct.a.source]=Object(i.jsx)(l.a,{message:"events.sources."+e.subscriptionChangeSource}));if(e.portalWide)n[Ct.a.subscription]=Object(i.jsx)(l.a,{message:"events.portalWide"});else if(e.brandWide){const s=t.find(s=>s.id===e.brandId).name;n[Ct.a.subscription]=s}else if(e.subscriptionId){const t=s.find(s=>s.id===e.subscriptionId);if(t){const{category:e,channel:s,name:i}=t;n[Ct.a.subscription]=e||s?`${e} ${s} | ${i}`:i}}return Object(i.jsx)("tr",{children:Object.keys(Ct.a).map(e=>Object(i.jsx)("td",{className:n[e]?"":"text-center",children:n[e]||"-"},e))})};var gi=({loaded:e,paginatedEvents:s,isBrand:t,emails:n,subscriptionTypes:a,brands:r})=>{const o=Object.keys(Ct.a).length;if(!e)return Object(i.jsx)("tr",{children:Object(i.jsx)("td",{colSpan:o,children:Object(i.jsx)(Ti.a,{minHeight:200})})});if(s.length<=0){const e=1===n.length?"noSingleHistory":"noHistory";return Object(i.jsx)("tr",{height:200,className:"text-center",children:Object(i.jsxs)("td",{colSpan:o,children:[Object(i.jsx)(l.a,{message:t?"events.noBrandHistory":"events."+e}),Object(i.jsx)("br",{}),n.join(", ")]})})}return s.map(e=>{const s=e.subscriptionId?e.timestamp+e.subscriptionId:"_"+Math.random().toString(36).substr(2,9);return Object(i.jsx)(Ei,{event:e,subscriptionTypes:a,brands:r},s)})};const Ci=({className:e,emails:s,historyEvents:t,historySubscriptions:n=[],historyBrands:a=[],isBrand:r,pageCount:o=15})=>{const[c,u]=Object(T.useState)([]),[l,b]=Object(T.useState)(n),[d,p]=Object(T.useState)(a),[O,S]=Object(T.useState)(1),[h,j]=Object(T.useState)(!1);Object(T.useEffect)(()=>{if(null!=t){u(t);j(!0)}else ji(s).then(([e,s,t])=>{u(t);b(e.subscriptionDefinitions);p(s);j(!0)})},[s,t,O,o]);const m=({target:{value:e}})=>S(e),E=c.sort((e,s)=>s.timestamp-e.timestamp).slice((O-1)*o,O*o);return Object(i.jsxs)("div",{className:e,children:[Object(i.jsxs)(Ee.a,{children:[Object(i.jsx)("thead",{children:Object(i.jsx)(mi,{})}),Object(i.jsx)("tbody",{children:Object(i.jsx)(gi,{loaded:h,paginatedEvents:E,emails:s,isBrand:r,subscriptionTypes:l,brands:d})})]}),c.length>=o&&Object(i.jsx)(tt.a,{pageCount:Math.ceil(c.length/o),page:O,onPageChange:m})]})};Ci.propTypes={className:p.a.string,emails:p.a.array.isRequired,historyEvents:p.a.array,historySubscriptions:p.a.array,historyBrands:p.a.array,isBrand:p.a.bool,pageCount:p.a.number};var fi=Ci;class xi extends T.PureComponent{constructor(e){super(e);this.handleChange=(e,{target:{value:s}})=>{this.setState({[e]:s})};this.handleSubscriptionChange=(e,s)=>{this.setState({[e]:s.id})};this.handleCancel=()=>{this.handleResetState();this.props.handleCancel()};this.handleClose=()=>{this.handleResetState();this.props.handleHistoryClose();this.props.handleCancel()};this.handleResetState=()=>{this.setState({email:null,subscription:null,legalBasis:null,explanation:null,isAddingSubscription:!1})};this.handleSave=()=>{this.props.handleUpdateSubscription(this.state);this.handleCancel();this.handleClose()};this.handleAddSubscription=()=>{this.setState({isAddingSubscription:!0});this.props.toggleAddSubscriptionHistory()};this.state={email:null,subscription:null,legalBasis:null,explanation:null,isAddingSubscription:!1};this.partial=re()(ne.a)}renderAddSubscriptionButton(){const e=this.props.isEditable?"addSubscriptionButtonOptedOut":"cantEdit",s=this.props.isGloballyOptedOut||!this.props.isEditable;return Object(i.jsx)("div",{className:"text-center",children:Object(i.jsx)(xe.a,{disabled:!s,title:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions."+e}),children:Object(i.jsx)(de.a,{disabled:s,use:"tertiary-light",onClick:this.handleAddSubscription,size:"small",children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.addSubscriptionButton"})})})})}renderBackButton(){return Object(i.jsx)(be.a,{children:Object(i.jsx)(Q.a,{onClick:this.handleCancel,children:Object(i.jsx)(l.a,{message:"crm_components.GDPR.dialogs.addSubscription.historyBack"})})})}render(){const{isAddingSubscription:e,email:s,subscription:t,legalBasis:n,explanation:a}=this.state,r=!(t&&n&&a&&s);return Object(i.jsxs)(Se.a,{width:1200,children:[Object(i.jsxs)(Te.a,{children:[Object(i.jsx)(pe.a,{onClick:this.handleClose}),Object(i.jsx)(Ie.a,{children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions."+(e?"header":"subscriptionHistory")})})]}),Object(i.jsx)(je.a,{children:e?Object(i.jsxs)("div",{children:[this.renderBackButton(),Object(i.jsx)(le,{emails:this.props.emails,handleChange:this.handleChange,handleSubscriptionChange:this.handleSubscriptionChange})]}):Object(i.jsx)(fi,{emails:this.props.emails,pageCount:15})}),Object(i.jsx)(me.a,{children:e?Object(i.jsxs)("div",{children:[Object(i.jsx)(xe.a,{disabled:!r,title:Object(i.jsx)(l.a,{message:"crm_components.GDPR.buttons.disabled"}),children:Object(i.jsx)(de.a,{use:"primary",onClick:this.handleSave,disabled:r,children:Object(i.jsx)(l.a,{message:"crm_components.GDPR.buttons.save"})})}),Object(i.jsx)(de.a,{onClick:this.handleCancel,children:Object(i.jsx)(l.a,{message:"crm_components.GDPR.buttons.cancel"})})]}):this.renderAddSubscriptionButton()})]})}}xi.propTypes={emails:p.a.array,handleCancel:p.a.func,handleHistoryClose:p.a.func,handleUpdateSubscription:p.a.func,isEditable:p.a.bool.isRequired,toggleAddSubscriptionHistory:p.a.func,isGloballyOptedOut:p.a.bool};var Ii=xi,_i=e=>!0===e||"true"===e,Ri=t("xHov");const Ni="/cos-domains/v1/brands",Ai=()=>Ri.c(Ni).then(e=>Object(m.Map)().set("brandDomains",e));var Pi=t("5mx2"),Ui=t("0dUV"),yi=t("AgF4");Object(Ui.b)({namespace:Pi.h,fetch:Ai});var Mi=Object(Ui.a)({namespace:Pi.h,idIsValid:()=>!0}).defineName("BrandDomainsStore").register(yi.a),Di=t("9f1P"),Bi=t.n(Di),vi=t("v4FS"),Li=t("NfVS"),Gi=t("KO24"),wi=t("VErj"),Fi=t("dKJf"),Hi=t("LTV0");const ki=Bi.a.div.withConfig({displayName:"SubscriptionFeedbackQuestion__QuestionWrapped",componentId:"wwd1cn-0"})(["width:100%;height:42px;margin-bottom:4px;"]),Wi=Bi.a.span.withConfig({displayName:"SubscriptionFeedbackQuestion__StyledFeedbackWrapper",componentId:"wwd1cn-1"})(["float:right;min-height:42px;line-height:42px;"]),Ki=Bi.a.span.withConfig({displayName:"SubscriptionFeedbackQuestion__StyledFeedback",componentId:"wwd1cn-2"})(["margin-top:8px;margin-bottom:0;display:inline;"," "," ",""],e=>e.feedbackIsAnswered&&"\n    margin-right: 30px;\n  ",e=>e.fadeQuestion&&!e.feedbackIsAnswered&&"\n    transition: opacity 0.5s ease-out;\n    opacity: 0;\n  ",e=>e.fadeResponse&&"\n    transition: opacity 2s ease-in-out;\n    opacity: 0;\n  "),qi=Bi()(Hi.a).withConfig({displayName:"SubscriptionFeedbackQuestion__StyledSpinner",componentId:"wwd1cn-3"})(["float:right;margin-top:4px;width:81px;margin-bottom:0;"," ",""],e=>e.feedbackIsAnswered&&"\n    float: left;\n    width: 40px;\n  ",e=>e.fadeResponse&&"\n    transition: opacity 2s ease-in-out;\n    opacity: 0;\n  "),Vi=Bi.a.span.withConfig({displayName:"SubscriptionFeedbackQuestion__FloatedFollowupQuestion",componentId:"wwd1cn-4"})(["float:right;"]),Qi=Bi()(Q.a).withConfig({displayName:"SubscriptionFeedbackQuestion__StyledSubmitLink",componentId:"wwd1cn-5"})(["margin:16px;line-height:40px;"]),Yi=Bi()(te.a).withConfig({displayName:"SubscriptionFeedbackQuestion__StyledUITextArea",componentId:"wwd1cn-6"})(["float:left;width:300px !important;min-height:35px !important;padding-bottom:0 !important;padding-top:6px !important;height:35px !important;"]);class $i extends T.PureComponent{constructor(e){super(e);this.handleFollowupAnswerChange=this.handleFollowupAnswerChange.bind(this);this.handleFollowupAnswerClick=this.handleFollowupAnswerClick.bind(this);this.fadeQuestion=this.fadeQuestion.bind(this);this.state={feedbackIsAnswered:!1,fadeQuestion:!1,fadeResponse:!1,showFollowup:!1,followUpResponse:"",helpfulnessResponse:void 0}}fadeQuestion(){this.setState({fadeQuestion:!0,showFollowup:!1});setTimeout(()=>{this.setState({feedbackIsAnswered:!0})},450);setTimeout(()=>{this.setState({fadeResponse:!0})},2500)}handleInitialAnswerClick(e){Me.a.log("communicationSubscriptionCardInteraction",{action:"subscription feedback",isHelpful:e});this.setState({helpfulnessResponse:e});e?this.fadeQuestion():this.setState({showFollowup:!0})}handleFollowupAnswerClick(){const{followUpResponse:e}=this.state;Me.a.log("communicationSubscriptionCardInteraction",{action:"subscription feedback",textFeedback:e});this.fadeQuestion()}handleFollowupAnswerChange(e){this.setState({followUpResponse:e.target.value})}renderInitialQuestion(){const{fadeResponse:e,fadeQuestion:s,feedbackIsAnswered:t}=this.state;return Object(i.jsxs)(Wi,{children:[!t&&Object(i.jsx)(Ki,{feedbackIsAnswered:t,fadeResponse:e,fadeQuestion:s,children:Object(i.jsx)(b.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.feedback.question"})}),s?Object(i.jsx)(qi,{feedbackIsAnswered:t,fadeResponse:e,showResult:t,size:"small"}):Object(i.jsxs)("span",{children:[Object(i.jsx)(Q.a,{className:"m-x-4","data-test-id":"positive-sub-feedback",onClick:()=>this.handleInitialAnswerClick(!0),children:Object(i.jsx)(b.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.feedback.yesAnswer"})}),Object(i.jsx)(Q.a,{className:"m-right-6","data-test-id":"negative-sub-feedback",onClick:()=>this.handleInitialAnswerClick(!1),children:Object(i.jsx)(b.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.feedback.noAnswer"})})]}),t&&Object(i.jsx)(Ki,{feedbackIsAnswered:t,fadeResponse:e,fadeQuestion:s,children:Object(i.jsx)(b.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.feedback.response"})})]})}renderFollowupQuestion(){const{followUpResponse:e}=this.state;return Object(i.jsxs)(Vi,{children:[Object(i.jsx)(Yi,{onChange:this.handleFollowupAnswerChange,placeholder:O.a.text("cardGDPRSubscriptions.profileSidebarModule.subscriptions.feedback.tellUsMore"),rows:1}),Object(i.jsx)(Qi,{disabled:0===e.trim().length,onClick:this.handleFollowupAnswerClick,children:Object(i.jsx)(b.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.feedback.submitTellUsMore"})})]})}render(){const e=this.state.showFollowup?this.renderFollowupQuestion():this.renderInitialQuestion();return Object(i.jsx)(ki,{children:e})}}var zi=$i,Ji=t("1G8E"),Zi=t("5zIw"),Xi=t("LqZr"),en=t("JZQQ"),sn=t("RCaW"),tn=t("pw7o"),nn=t("WwwS"),an=t("fW34"),rn=t("AKxL"),on=t("oWZn");class cn extends T.PureComponent{constructor(e){super(e);this.selectLegalBasis=this.selectLegalBasis.bind(this);this.inputConsent=this.inputConsent.bind(this);this.state={selectedLegalBasis:null,inputConsentExplanation:"",hasInputSelectedLegalBasis:!1,hasInputConsentExplanation:!1}}selectLegalBasis(e){this.setState({selectedLegalBasis:e.target.value,hasInputSelectedLegalBasis:!0})}inputConsent(e){this.setState({inputConsentExplanation:e.target.value,hasInputConsentExplanation:!0})}renderSubscribeButton(e){const{subscribeEmail:s,subscription:t}=this.props,{selectedLegalBasis:n,inputConsentExplanation:a}=this.state;return Object(i.jsx)(de.a,{"data-test-id":"subscribe-button","data-selenium-test":"subscribe-modal-button",use:"primary",disabled:e,onClick:()=>s(t,n,a),children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.confirmButton"})})}render(){const{subscription:e,closeModal:s,email:t,isGdprComplianceEnabled:n}=this.props,{selectedLegalBasis:a,inputConsentExplanation:r,hasInputSelectedLegalBasis:o,hasInputConsentExplanation:c}=this.state,u=!a&&n||""===r,b=""===r&&c,d=!a&&o;return Object(i.jsxs)(tn.a,{width:1e3,"data-selenium-test":"subscribe-modal",children:[Object(i.jsxs)(rn.a,{children:[Object(i.jsx)(pe.a,{onClick:s}),Object(i.jsx)(Ie.a,{children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.header"})})]}),Object(i.jsx)(nn.a,{children:Object(i.jsxs)(on.a,{children:[Object(i.jsx)(be.a,{onClick:s,children:Object(i.jsx)(Q.a,{onClick:s,children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.backButton"})})}),Object(i.jsx)(sn.a,{children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.formHeader",options:{email:t,subscriptionName:e.name}})}),n&&Object(i.jsx)(S.a,{onChange:this.selectLegalBasis,formControlProps:{required:!0,error:d,validationMessage:d?O.a.text("cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.legalBasisDescription"):""}}),Object(i.jsx)(A.a,{required:!0,label:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.consentHeader"}),error:b,validationMessage:b?O.a.text("cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.requiredConsentDescription"):"",children:Object(i.jsx)(te.a,{"data-selenium-test":"subscription-consent-input",onChange:this.inputConsent,placeholder:O.a.text("cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.consentDescription")})})]})}),Object(i.jsxs)(an.a,{children:[u?Object(i.jsx)(xe.a,{placement:"top",title:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.missingInputs"}),children:this.renderSubscribeButton(u)}):this.renderSubscribeButton(u),Object(i.jsx)(de.a,{onClick:s,children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.cancelButton"})})]})]})}}cn.propTypes={closeModal:p.a.func,subscribeEmail:p.a.func,email:p.a.string,subscription:p.a.object,isGdprComplianceEnabled:p.a.bool};var un=cn;class ln extends T.PureComponent{render(){const{subscription:e,closeModal:s,unsubscribeEmail:t,email:n}=this.props;return Object(i.jsxs)(he.a,{use:"success",width:500,"data-selenium-test":"unsubscribe-modal",children:[Object(i.jsxs)(Te.a,{children:[Object(i.jsx)(pe.a,{onClick:s}),Object(i.jsx)(Ie.a,{children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.unsubscribe.header",options:{email:n,subscriptionName:e.name}})})]}),Object(i.jsx)(je.a,{children:Object(i.jsx)(b.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.unsubscribe.body",options:{subscriptionName:e.name}})}),Object(i.jsxs)(me.a,{children:[Object(i.jsx)(de.a,{"data-selenium-test":"unsubscribe-modal-button",use:"primary",onClick:()=>t(e),children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.unsubscribe.confirmButton"})}),Object(i.jsx)(de.a,{onClick:s,children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.unsubscribe.cancelButton"})})]})]})}}ln.propTypes={closeModal:p.a.func,unsubscribeEmail:p.a.func,email:p.a.string,subscription:p.a.object};var bn=ln,dn=t("VukZ");class pn extends T.PureComponent{constructor(e){super(e);this.renderSubscriptionRow=this.renderSubscriptionRow.bind(this);this.closeModal=this.closeModal.bind(this);this.subscribeEmail=this.subscribeEmail.bind(this);this.unsubscribeEmail=this.unsubscribeEmail.bind(this);this.state={selectedTab:"subs",showUnsubscribeModal:!1,showSubscribeModal:!1,modalSubscription:{}}}closeModal(){this.setState({showUnsubscribeModal:!1,showSubscribeModal:!1})}openSubscribeModal(e){this.setState({showSubscribeModal:!0,modalSubscription:e})}openUnsubscribeModal(e){this.setState({showUnsubscribeModal:!0,modalSubscription:e})}subscribeEmail(e,s,t){const{emailSubscriptions:i,isGdprComplianceEnabled:n,isGdprComplianceEnforced:a}=this.props;Object(o.f)(i.email,{lawfulBasis:s,legalBasis:s,subscriptionId:e.id,explanation:t,optState:dn.b.OPT_IN});Me.a.log("communicationSubscriptionCardInteraction",{action:"subscribe action",isGdprEnabled:n,isGdprEnforced:a});this.closeModal()}unsubscribeEmail(e){const{emailSubscriptions:s,isGdprComplianceEnabled:t,isGdprComplianceEnforced:i}=this.props;Object(o.f)(s.email,{subscriptionId:e.id,optState:dn.b.OPT_OUT});Me.a.log("communicationSubscriptionCardInteraction",{action:"unsubscribe action",isGdprEnabled:t,isGdprEnforced:i});this.closeModal()}renderUnsubscribeButton(e){return Object(i.jsx)(de.a,{"data-test-id":"unsubscribe-button","data-selenium-test":"unsubscribe-button",responsive:!1,size:"extra-small",use:"tertiary-light",onClick:()=>{this.openUnsubscribeModal(e)},children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.unsubscribe.confirmButton"})})}renderSubscribeButton(e){const{isGdprComplianceEnabled:s}=this.props,t=e.isUnsubscribed(),n=!e.isNotSpecified(),a=Object(i.jsx)(de.a,{"data-test-id":"subscribe-button","data-selenium-test":"subscribe-button",disabled:n,responsive:!1,size:"extra-small",use:"tertiary-light",onClick:()=>{t||s?this.openSubscribeModal(e,t):this.subscribeContact(e)},children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.confirmButton"})});return n?Object(i.jsx)(xe.a,{placement:"top",title:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.tableActions.subscribe.disabled"}),children:a}):a}renderActionButtons(e){const{isGdprComplianceEnabled:s}=this.props,t=e.isUnsubscribed(),n=e.isNotSpecified();return Object(i.jsxs)(T.Fragment,{children:[!t&&this.renderUnsubscribeButton(e),(n&&s||t)&&this.renderSubscribeButton(e)]})}renderSubscriptionRow(e){const{isGdprComplianceEnabled:s,isGdprComplianceEnforced:t,canUpdateSubscriptions:n}=this.props,a=e.isNotSpecified();let r="subscribed",o="success";if(e.isUnsubscribed()){r="unsubscribed";o="danger"}else if(a&&s){r="notSubscribed";o="default"}return Object(i.jsxs)("tr",{"data-selenium-test":"subscription-row","selenium-opt-state-test":e.optState,children:[Object(i.jsx)("td",{children:e.name}),Object(i.jsxs)("td",{children:[Object(i.jsx)(Ut.a,{"data-selenium-test":"subscription-row-status","data-selenium-status-dot-test":o,use:o}),Object(i.jsx)(Fi.a,{style:{fontWeight:400},children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.status."+r})}),a&&s&&Object(i.jsx)(Zi.a,{className:"m-left-2",title:Object(i.jsx)(Li.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.status."+(t?"notSubscribedGdprEnforcedTooltip_jsx":"notSubscribedGdprNotEnforcedTooltip_jsx"),options:{href:"https://knowledge.hubspot.com/contacts/how-do-subscription-preferences-and-types-work"},elements:{Link:Q.a}})})]}),Object(i.jsx)("td",{children:Object(i.jsx)(en.a,{children:n&&this.renderActionButtons(e)})})]},e.id)}renderEmptyState(e,s=!1,t=!1){const{emailSubscriptions:n,brandDomains:a}=this.props,{email:r,brandDomainId:o}=n;let c=null;o&&(c=a.find(e=>e.get("id")===o).get("name"));return Object(i.jsx)(Ji.a,{titleText:Object(i.jsx)(b.a,{message:`cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.emptyState.${e}Header`,options:{email:r}}),primaryContent:Object(i.jsxs)("div",{children:[Object(i.jsx)(b.a,{message:`cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.emptyState.${e}Body`,options:{email:r,brandDomain:c}}),s&&Object(i.jsx)("div",{className:"m-top-5",children:Object(i.jsx)(de.a,{use:"tertiary",onClick:()=>{this.setState({selectedTab:"history"})},children:Object(i.jsx)(b.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.emptyState.viewHistoryButton"})})}),t&&Object(i.jsx)("div",{className:"m-top-5",children:Object(i.jsx)(de.a,{use:"tertiary",href:`/settings/${V.a.get()}/marketing/email/preferences-center`,external:!0,children:Object(i.jsx)(b.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.emptyState.createSubscriptionButton"})})})]}),secondaryContent:Object(i.jsx)(Xi.a,{name:"no-conversations",width:"40%"})},e)}renderSubscriptionTable(){const{emailSubscriptions:e}=this.props,{subscriptions:s,isPortalWideOptedOut:t,brandWideOptOut:n,isBrand:a}=e;return 0===s.length?a?this.renderEmptyState("noBrandSubscriptions",!1,!0):this.renderEmptyState("noPortalSubscriptions",!1,!0):n?this.renderEmptyState("brandOptOut",!0):t?this.renderEmptyState("portalOptOut",!0):Object(i.jsxs)(Ee.a,{bordered:!0,"data-selenium-test":"subscription-status-content",children:[Object(i.jsxs)("colgroup",{children:[Object(i.jsx)("col",{style:{width:"33%"}}),Object(i.jsx)("col",{style:{width:"25%"}}),Object(i.jsx)("col",{style:{width:"42%"}})]}),Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.header.subType"})}),Object(i.jsx)("th",{children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.header.status"})}),Object(i.jsx)("th",{})]})}),Object(i.jsx)("tbody",{children:s.map(this.renderSubscriptionRow)})]})}renderHistoryTable(){const{emailSubscriptions:e}=this.props;return Object(i.jsx)("div",{"data-selenium-test":"subscription-history-content",children:Object(i.jsx)(fi,{historyEvents:e.history.toJSON(),historySubscriptions:e.subscriptions.toJSON(),emails:[e.email],isBrand:e.isBrand,pageCount:8})})}render(){const{showSubscribeModal:e,showUnsubscribeModal:s,selectedTab:t,modalSubscription:n}=this.state,{emailSubscriptions:a,isGdprComplianceEnabled:r}=this.props;return Object(i.jsxs)("div",{"data-selenium-test":"subscription-status-table",children:[Object(i.jsxs)(Zs.a,{panelClassName:"p-x-0",selected:t,children:[Object(i.jsx)(Js.a,{tabId:"subs",title:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.tab.subscriptions",options:{count:a.subscriptions.length}}),onClick:()=>{this.setState({selectedTab:"subs"})},children:this.renderSubscriptionTable()}),Object(i.jsx)(Js.a,{tabId:"history",title:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.statusTable.tab.history"}),onClick:()=>{this.setState({selectedTab:"history"});Me.a.log("communicationSubscriptionCardInteraction",{action:"view history"})},children:this.renderHistoryTable()})]}),e&&Object(i.jsx)(un,{closeModal:this.closeModal,isGdprComplianceEnabled:r,subscribeEmail:this.subscribeEmail,email:a.email,subscription:n}),s&&Object(i.jsx)(bn,{closeModal:this.closeModal,unsubscribeEmail:this.unsubscribeEmail,email:a.email,subscription:n})]})}}pn.propTypes={brandDomains:p.a.object,emailSubscriptions:p.a.object,isGdprComplianceEnabled:p.a.bool,isGdprComplianceEnforced:p.a.bool,canUpdateSubscriptions:p.a.bool};var On=pn;const Sn=Bi()(je.a).withConfig({displayName:"UpdatedSubscriptionsPanel__StyledUIDialogBody",componentId:"sc-1f7fy6d-0"})(["padding-top:16px !important;"]),hn=Bi()(vi.a).withConfig({displayName:"UpdatedSubscriptionsPanel__StyledUIExpandableSection",componentId:"sc-1f7fy6d-1"})(["border:1px solid ",";border-top:0;border-bottom:0;&:last-child{border-bottom:1px solid ",";}"],yt.GREAT_WHITE,yt.GREAT_WHITE);class jn extends T.PureComponent{constructor(e){super(e);this.renderEmailSubscriptionsAccordion=this.renderEmailSubscriptionsAccordion.bind(this)}maybeRenderGDPRNote(){const{isGdprComplianceEnabled:e,isGdprComplianceEnforced:s}=this.props;return e?Object(i.jsx)("p",{"data-test-id":"gdpr-note","data-selenium-test":"gdpr-note",children:Object(i.jsx)(Li.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.gdprNote_jsx",options:{href:"https://knowledge.hubspot.com/contacts/how-do-subscription-preferences-and-types-work",onClick:()=>{Me.a.log("communicationSubscriptionCardInteraction",{action:"gdpr note click",isGdprEnabled:e,isGdprEnforced:s})}},elements:{Link:Q.a}})}):null}renderSubscriptionStatusTable(e){const{brandDomains:s,isGdprComplianceEnabled:t,isGdprComplianceEnforced:n,canUpdateSubscriptions:a,subjectId:r}=this.props;return Object(i.jsx)(On,{brandDomains:s,isGdprComplianceEnabled:t,isGdprComplianceEnforced:n,emailSubscriptions:e,canUpdateSubscriptions:a,subjectId:r})}renderPreferenceGroupSubscriptions(){const{primaryEmailSubscriptions:e,preferenceGroupsWithStatuses:s}=this.props,t=s.get("brands"),n=s.get("unassigned").get("subscriptions"),a=s.get("unassigned").get("history"),r=s.get("default").get("subscriptions"),o=s.get("default").get("history"),{email:c,isPortalWideOptedOut:u}=e;return Object(i.jsxs)("div",{"data-test-id":"brands-expandable-header","data-selenium-test":"brands-expandable-header",children:[!r.isEmpty()&&this.renderEmailSubscriptionsAccordion({subscriptions:r,history:o,email:c,isPortalWideOptedOut:u},{isPrimary:!1,headerKey:"defaultBrand"}),!n.isEmpty()&&this.renderEmailSubscriptionsAccordion({subscriptions:n,history:a,email:c,isPortalWideOptedOut:u},{isPrimary:!1,headerKey:"unassignedBrand"}),t.map(e=>this.renderEmailSubscriptionsAccordion(Object.assign({},e,{email:c,isPortalWideOptedOut:u,isBrand:!0}),{isPrimary:!0,headerKey:"brandHeader"}))]})}renderSubscriptionHeadline(e,s,t,n,a,r=null){const{isPortalWideOptedOut:o,brandWideOptOut:c,email:u,name:b,subscriptions:d}=a,p=r?r+"Status":e?"primaryHeaderStatus":"secondaryHeaderStatus",O=Object(dn.d)(p,s,t,n),S=o||c||Object(dn.h)(d)?"optedOut":O;return Object(i.jsx)(l.a,{"data-test-id":S,"data-selenium-test":S,message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions."+S,options:{count:s,notSpecifiedCount:n,unsubscribedCount:t,emailName:u,brandName:b}})}renderEmailSubscriptionsAccordion(e,s={}){const{email:t,name:n,id:a,subscriptions:r,isBrand:o,isPortalWideOptedOut:c,brandWideOptOut:u}=e,{isPrimary:b=!0,headerKey:d=null}=s,{isGdprComplianceEnabled:p}=this.props,O=!o&&!d&&!b,{subscribedCount:S,unsubscribedCount:h,notSubscribedCount:j}=Object(dn.f)(r,p);let m="success";0===S&&(m=c||u||h>0?"danger":"default");return Object(i.jsx)(hn,{"data-test-id":"expandable-subscription-border","data-selenium-test":"expandable-subscription-border",expandable:!0,defaultExpanded:!1,onClick:()=>{let e="open primary";o?e="open brand":d?e="open default":O&&(e="open secondary");Me.a.log("communicationSubscriptionCardInteraction",{action:e})},titleText:Object(i.jsxs)("div",{children:[Object(i.jsx)(Gi.a,{className:"display-inline m-right-3",children:!d||o?n||t:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions."+d})}),Object(i.jsxs)("span",{children:[Object(i.jsx)(Ut.a,{use:m}),Object(i.jsx)(Fi.a,{style:{fontWeight:400},children:this.renderSubscriptionHeadline(b,S,h,j,e,d)})]})]}),children:this.renderSubscriptionStatusTable(e)},a||d||t)}renderEmailSubscriptions(e,s=!0){const{subscriptions:t,id:n}=e,{isGdprComplianceEnabled:a}=this.props,{subscribedCount:r,unsubscribedCount:o,notSubscribedCount:c}=Object(dn.f)(t,a);return Object(i.jsxs)(T.Fragment,{children:[this.renderSubscriptionHeadline(s,r,o,c,e),this.renderSubscriptionStatusTable(e)]},n)}renderPrimaryEmailSubscriptions(){const{primaryEmailSubscriptions:e,secondaryEmailSubscriptions:s}=this.props;return 0===s.length?this.renderEmailSubscriptions(e):Object(i.jsxs)("div",{"data-test-id":"primary-expandable-header","data-selenium-test":"primary-expandable-header",children:[Object(i.jsx)(wi.a,{className:"m-bottom-1",children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.primaryHeader"})}),Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.primaryHeaderDescription"}),this.renderEmailSubscriptionsAccordion(e)]})}renderSecondaryEmailSubscriptions(){const{secondaryEmailSubscriptions:e}=this.props;return Object(i.jsxs)("div",{"data-test-id":"secondary-expandable-header","data-selenium-test":"secondary-expandable-header",children:[Object(i.jsx)(wi.a,{className:"m-bottom-1 m-top-6",children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.secondaryHeader"})}),Object(i.jsx)(l.a,{className:"m-bottom-1",message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.secondaryHeaderDescription"}),e.map(e=>this.renderEmailSubscriptionsAccordion(e,{isPrimary:!1}))]})}render(){const{secondaryEmailSubscriptions:e,preferenceGroupsWithStatuses:s}=this.props,t=s.get("brands").size>0;return Object(i.jsxs)(Se.a,{width:1e3,"data-selenium-test":"subscription-panel",children:[Object(i.jsxs)(Te.a,{children:[Object(i.jsx)(pe.a,{onClick:this.props.handleClose}),Object(i.jsx)(Ie.a,{children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.panelHeader"})})]}),Object(i.jsxs)(Sn,{children:[Object(i.jsx)(zi,{}),this.maybeRenderGDPRNote(),t?this.renderPreferenceGroupSubscriptions():this.renderPrimaryEmailSubscriptions(),e.length>0&&this.renderSecondaryEmailSubscriptions()]})]})}}jn.propTypes={brandDomains:p.a.object,handleClose:p.a.func,isGdprComplianceEnabled:p.a.bool,isGdprComplianceEnforced:p.a.bool,preferenceGroupsWithStatuses:p.a.object,primaryEmailSubscriptions:p.a.object,secondaryEmailSubscriptions:p.a.array,canUpdateSubscriptions:p.a.bool,subjectId:p.a.number};var mn=jn,Tn=t("VQUG");class En extends h.a{constructor(...e){super(...e);this.state={showPanel:!1};this.handleOpenSubscriptionPanel=()=>{Me.a.log("communicationSubscriptionCardInteraction",{action:"open updated subscription panel"});this.setState({showPanel:!0})};this.handleCloseSubscriptionPanel=()=>{const{showPanel:e}=this.state;this.setState({showPanel:!e})}}renderSubscriptionAggregate(e,s,t,n,a){let r="success";0===s&&(r=t>0?"danger":"default");return Object(i.jsxs)("div",{"data-test-id":a,"data-selenium-test":a,children:[Object(i.jsx)(Ut.a,{use:r}),Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.card."+a,options:{email:e,count:s,notSpecifiedCount:n,unsubscribedCount:t}})]},a)}renderPrimarySubscriptionsAggregate(){const{primaryEmailSubscriptions:e,secondaryEmailSubscriptions:s,preferenceGroupsWithStatuses:t,isGdprComplianceEnabled:i}=this.props;if(!e||!s||!t)return null;let n={subscribedCount:0,unsubscribedCount:0,notSubscribedCount:0};if(!e.isPortalWideOptedOut)if(t.get("brands").size>0){const e=Object(dn.f)(t.getIn(["unassigned","subscriptions"]),i),s=Object(dn.f)(t.getIn(["default","subscriptions"]),i),a=t.get("brands").reduce((e,s)=>{if(!s.brandWideOptOut){const t=Object(dn.f)(s.subscriptions,i);return{subscribedCount:e.subscribedCount+t.subscribedCount,unsubscribedCount:e.unsubscribedCount+t.unsubscribedCount,notSubscribedCount:e.notSubscribedCount+t.notSubscribedCount}}return e},{subscribedCount:0,unsubscribedCount:0,notSubscribedCount:0});n={subscribedCount:e.subscribedCount+s.subscribedCount+a.subscribedCount,unsubscribedCount:e.unsubscribedCount+s.unsubscribedCount+a.unsubscribedCount,notSubscribedCount:e.notSubscribedCount+s.notSubscribedCount+a.notSubscribedCount}}else n=Object(dn.f)(e.subscriptions.toArray(),i);const a=s.length>0;let r="";if(e.isPortalWideOptedOut||Object(dn.h)(e.subscriptions))r=a?"primaryOptedOutWithDescriptor":"primaryOptedOut";else{const{subscribedCount:e,unsubscribedCount:s,notSubscribedCount:t}=n;r=Object(dn.d)("primary",e,s,t,a)}return this.renderSubscriptionAggregate(e.email,n.subscribedCount,n.unsubscribedCount,n.notSubscribedCount,r)}renderSecondarySubscriptionsAggregates(){const{secondaryEmailSubscriptions:e,isGdprComplianceEnabled:s}=this.props;return e&&0!==e.length?e.map(e=>{let t={subscribedCount:0,unsubscribedCount:0,notSubscribedCount:0};e.isPortalWideOptedOut||(t=Object(dn.f)(e.subscriptions,s));const{subscribedCount:i,unsubscribedCount:n,notSubscribedCount:a}=t;let r="";r=e.isPortalWideOptedOut||Object(dn.h)(e.subscriptions)?"secondaryOptedOutWithDescriptor":Object(dn.d)("secondary",i,n,a,!0);return this.renderSubscriptionAggregate(e.email,i,n,a,r)}):null}renderCard(){const{canEditSubject:e}=this.props;return Object(i.jsxs)("div",{"data-selenium-test":"subscriptions-card",children:[this.renderPrimarySubscriptionsAggregate(),this.renderSecondarySubscriptionsAggregates(),Object(i.jsx)(Tn.a,{justify:"center",className:"m-top-2",children:Object(i.jsx)(de.a,{"data-selenium-test":"subscriptions-card-manage-button",onClick:this.handleOpenSubscriptionPanel,size:"extra-small",use:"tertiary-light",children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.card."+(e?"manageSubscriptions":"viewSubscriptions")})})})]})}render(){const{brandDomains:e,preferenceGroupsWithStatuses:s,primaryEmailSubscriptions:t,secondaryEmailSubscriptions:n}=this.props;return Object(a.d)(e)||Object(a.d)(s)||Object(a.d)(t)||Object(a.d)(n)?Object(i.jsx)(ye.a,{}):Object(i.jsxs)("div",{children:[this.renderCard(),this.state.showPanel&&Object(i.jsx)(mn,{brandDomains:this.props.brandDomains,handleClose:this.handleCloseSubscriptionPanel,isGdprComplianceEnabled:this.props.isGdprComplianceEnabled,isGdprComplianceEnforced:this.props.isGdprComplianceEnforced,primaryEmailSubscriptions:this.props.primaryEmailSubscriptions,secondaryEmailSubscriptions:this.props.secondaryEmailSubscriptions,preferenceGroupsWithStatuses:this.props.preferenceGroupsWithStatuses,canUpdateSubscriptions:this.props.canEditSubject,subjectId:this.props.subjectId})]})}}En.propTypes={brandDomains:p.a.object,isGdprComplianceEnabled:p.a.bool,isGdprComplianceEnforced:p.a.bool,primaryEmailSubscriptions:p.a.object,secondaryEmailSubscriptions:p.a.array,preferenceGroupsWithStatuses:p.a.object,subjectId:p.a.number,canEditSubject:p.a.bool};var gn=En;const Cn="subscriptions/v1/definitions",fn=()=>Ri.c(Cn).then(e=>Object(m.Map)().set("subscriptionDefinitions",e));Object(Ui.b)({namespace:Pi.sb,fetch:fn});var xn=Object(Ui.a)({namespace:Pi.sb,idIsValid:()=>!0}).defineName("UpdatedSubscriptionDefinitionsStore").register(yi.a),In=t("sdjV"),_n=t("RRvD");const Rn="SOURCE_HUBSPOT_CUSTOMER";Object(Ui.b)({namespace:Pi.ub,fetch:In.a});var Nn=Object(Ui.a)({namespace:Pi.ub,idIsValid:e=>"string"==typeof e}).defineName("UpdatedSubscriptionStatusStore").defineResponseTo(_n.SUBSCRIPTION_RELATIONSHIP_UPDATE_SUCCEEDED,(e,{email:s,updatedSubscription:t})=>{const i=e.getIn([s,"subscriptionStatuses"])||Object(m.List)(),n=i.findIndex(e=>e.get("subscriptionId")===t.subscriptionId);if(n>-1){const i=e.getIn([s,"subscriptionStatuses",n]).set("optState",t.optState).set("legalBasis",t.legalBasis).set("legalBasisExplanation",t.legalBasisExplanation);return e.setIn([s,"subscriptionStatuses",n],i)}return e.setIn([s,"subscriptionStatuses"],i.push(Object(m.fromJS)(Object.assign({},t,{source:Rn}))))}).register(yi.a),An=t("KAn6");Object(Ui.b)({namespace:Pi.tb,fetch:An.a});var Pn=Object(Ui.a)({namespace:Pi.tb,idIsValid:e=>"string"==typeof e}).defineName("UpdatedSubscriptionHistoryStore").register(yi.a),Un=t("al+t");Object(Ui.b)({namespace:Pi.gb,fetch:Un.b});var yn=Object(Ui.a)({namespace:Pi.gb,idIsValid:()=>!0}).defineName("SubscriptionsStoreByBrand").register(yi.a),Mn=t("w+Se"),Dn=t.n(Mn);const Bn="DATA_PRIVACY_HUB_SETTINGS";function vn(e){return M.a.get("/data-privacy-settings/hub-settings",{query:{keys:e.toArray()}}).then(e=>Object(m.Map)().withMutations(s=>{if(e)for(const[t,i]of Object.entries(e))s.set(t,i)})).catch(e=>Object(m.Map)())}Object(Ui.b)({namespace:Bn,fetch:vn,fetchLimit:100,deserializeData:di.a});const Ln=Object(Ui.a)({namespace:Bn,idIsValid:Dn.a}).register(yi.a),Gn={source:null,legalBasis:null,optState:dn.b.NOT_OPTED},wn=Object.assign({id:null,name:"",category:null,defaultSubscription:null,channel:null},Gn);function Fn(e,s){const t=e.get("subscriptionStatuses");if(!t)return Object(m.Map)(Gn);return t.find(e=>e.get("subscriptionId")===s)||Object(m.Map)(Gn)}class Hn extends(Object(m.Record)(wn)){static from(e,s){const t=Fn(s,e.get("id"));return new Hn({id:e.get("id"),name:e.get("name"),defaultSubscription:e.get("defaultSubscription"),category:e.get("process"),channel:e.get("operation"),legalBasis:t.get("legalBasis"),source:t.get("source"),optState:t.get("optState")})}canCommunicate(e){return e?this.isSubscribed():!this.isUnsubscribed()}isSubscribed(){return this.optState===dn.b.OPT_IN}isUnsubscribed(){return this.optState===dn.b.OPT_OUT}isNotSpecified(){return this.optState===dn.b.NOT_OPTED}}var kn=Hn;const Wn=Object(m.Record)({subscriptions:[],history:[]}),Kn={brands:[],unassigned:Wn(),default:Wn()},qn=(e,s,t)=>{let i=Object(m.Set)();const n=e.map(e=>{const n=e.get("preferencesGroup"),a=e.get("translatedSubscriptionDefinitions"),r=a.filter(e=>!e.getIn(["subscriptionDefinition","defaultSubscription"])).map(e=>e.getIn(["subscriptionDefinition","id"]));i=i.union(r);const o=n.get("brandDomainId"),c=s.get("brandStatusesByBrand").get(""+o);return{id:n.get("id"),name:n.get("name"),brandWideOptOut:c&&c.get("brandWide")&&c.get("optState")===dn.b.OPT_OUT,brandDomainId:o,subscriptions:a.reduce((e,t)=>{const i=t.get("subscriptionDefinition");return i.get("defaultSubscription")?e:e.push(kn.from(i,s))},Object(m.List)()),history:t.filter(e=>e.get("subscriptionId")&&r.contains(e.get("subscriptionId"))||e.get("isBrandWide")&&e.get("brandId")===o)}});return{assignedSubscriptionIds:i,brandsWithStatuses:n}},Vn=(e,s,t)=>e.reduce((e,i)=>{const n=i.get("defaultSubscription");return s.contains(i.get("id"))||n?e:e.push(kn.from(i,t))},Object(m.List)()),Qn=(e,s,t)=>e.filter(e=>{const i=e.get("subscriptionId"),n=i&&!s.contains(i)&&!t.contains(i),a=e.get("isPortalWide")&&e.get("optState")===dn.b.OPT_OUT;return n||a}),Yn=(e,s)=>{const t=e.reduce((e,t)=>t.get("defaultSubscription")?e.push(kn.from(t,s)):e,Object(m.List)());return{defaultSubscriptionsWithStatuses:t,defaultSubscriptionIds:t.map(e=>e.id)}},$n=(e,s)=>e.filter(e=>{const t=e.get("subscriptionId")&&s.contains(e.get("subscriptionId")),i=e.get("isPortalWide")&&e.get("optState")===dn.b.OPT_OUT;return t||i});class zn extends(Object(m.Record)(Kn)){static from(e,s,t,i){if(!e||0===e.length)return new zn(Kn);const{assignedSubscriptionIds:n,brandsWithStatuses:a}=qn(e,t,i),{defaultSubscriptionIds:r,defaultSubscriptionsWithStatuses:o}=Yn(s,t);return new zn({brands:a,unassigned:Wn({subscriptions:Vn(s,n,t),history:Qn(i,n,r)}),default:Wn({subscriptions:o,history:$n(i,r)})})}}var Jn=zn;const Zn={email:"",isPortalWideOptedOut:!1,subscriptions:Object(m.List)([]),history:[]};class Xn extends(Object(m.Record)(Zn)){static from(e,s,t=[]){if(!e)return new Xn(Zn);const i=e.statuses.get("portalWideStatus");return new Xn({email:e.email,isPortalWideOptedOut:Object(dn.g)(i),subscriptions:s.reduce((s,i)=>{if(t.length>0){const e=i.get("defaultSubscription");if(-1===t.indexOf(e))return s}return s.push(kn.from(i,e.statuses))},Object(m.List)()),history:e.history})}}var ea=Xn,sa=t("zWK0"),ta=Object(sa.a)(Object(Be.connect)({preferenceGroupsWithStatuses:{stores:[yn,n.a,Nn,Pn,xn],deref:({subjectId:e})=>{const s=yn.get("subscriptionBrands"),t=n.a.get(e),i=Object(Ue.g)(t,"email"),r=Nn.get(i),o=Pn.get(i),c=xn.get("subscriptionDefinitions");return Object(a.d)(s)||Object(a.d)(r)||Object(a.d)(o)||Object(a.d)(c)?a.b:Jn.from(s,c,r,o)}},brandDomains:{stores:[Mi],deref:()=>{const e=Mi.get("brandDomains");return Object(a.d)(e)?a.b:e}},primaryEmailSubscriptions:{stores:[n.a,Nn,xn,Pn],deref:({subjectId:e})=>{const s=n.a.get(e),t=Object(Ue.g)(s,"email");if(!t)return a.b;const i=Nn.get(t),r=Pn.get(t),o=xn.get("subscriptionDefinitions");if(Object(a.d)(i)||Object(a.d)(r)||Object(a.d)(o))return a.b;const c={email:t,statuses:i,history:r};return ea.from(c,o)}},secondaryEmailSubscriptions:{stores:[n.a,Nn,Pn,xn],deref:({subjectId:e})=>{const s=n.a.get(e),t=Object(dn.e)(s);if(!t)return a.b;const i=t.map(e=>({email:e,statuses:Nn.get(e),history:Pn.get(e)})),r=xn.get("subscriptionDefinitions");return i.some(e=>Object(a.d)(e.statuses)||Object(a.d)(e.history))||Object(a.d)(r)?a.b:i.map(e=>ea.from(e,r,[dn.a]))}},isGdprComplianceEnabled:{stores:[Ln],deref:()=>_i(Ln.get("gdprToggleEnabled"))},isGdprComplianceEnforced:{stores:[Ln],deref:()=>_i(Ln.get("legalBasisRequirementEnabled"))}})(gn));t.d(s,"WrappedComponent",(function(){return ca}));const ia={auth:p.a.object,emails:p.a.arrayOf(p.a.string),firstName:p.a.string,lastName:p.a.string,handleOpenAddSubscriptionPanel:p.a.func.isRequired,isAddingSubscription:p.a.bool.isRequired,isEditable:p.a.bool.isRequired,isUngatedForUpdatedSubscriptionsCard:p.a.bool,isUngatedForPreferencesGroupBeta:p.a.bool,setIsAddingSubscription:p.a.func.isRequired,setShowPanel:p.a.func.isRequired,showPanel:p.a.bool.isRequired,subject:Pe.a,subscriptionDefinitionsById:fe.a.map,subscriptionsByEmail:p.a.array},na=Object(Le.a)({SINGLE_SUBSCRIPTION_RESUB_ERROR:null,PORTAL_WIDE_RESUB_ERROR:null});function aa(e){let s="";s=e.get("category")?e.get("category")+" ":s;s=e.get("channel")?`${s}${e.get("channel")} `:s;s=s?`${s}| ${e.get("name")}`:e.get("name");return s}const ra=re()((e,s)=>e&&s?s.reduce((s,t)=>{t.get("subscriptionStatuses").forEach(i=>{const n=e.get(i.get("id"));n&&n.get("active")&&"OPT_IN"===i.get("optState")&&(s=s.push({id:i.get("id"),email:t.get("email"),label:aa(n)}))});return s},Object(m.List)()):null),oa=()=>pi.a.addAlert({titleText:O.a.text("cardGDPRSubscriptions.alert.subscriptionUpdateErrorTitle"),message:O.a.text("cardGDPRSubscriptions.alert.subscriptionUpdateErrorMessage"),type:"danger","data-alert-type":"danger"}),ca=({auth:e,emails:s,firstName:t,lastName:n,handleOpenAddSubscriptionPanel:r,isAddingSubscription:c,isEditable:u,isUngatedForUpdatedSubscriptionsCard:b,isUngatedForPreferencesGroupBeta:d,setIsAddingSubscription:p,setShowPanel:O,showPanel:S,subject:h,subscriptionDefinitionsById:j,subscriptionsByEmail:m})=>{const[E,g]=Object(T.useState)(!1),C=()=>{Me.a.log("communicationSubscriptionCardInteraction",{action:"open current subscriptions"});O(!0)},f=()=>{O(!1);p(!1)},x=()=>{p(!1)},I=()=>{Me.a.log("communicationSubscriptionCardInteraction",{action:"open subscription history"});g(!0)},_=()=>{g(!E)},R=({lawfulBasis:e,subscription:s,explanation:t,email:i})=>{const n=aa(j.get(s));Object(o.d)(i,{lawfulBasis:e,legalBasis:e,subscription:s,explanation:t}).then(()=>{De.d("crm_components.GDPR.alerts.removeSubscription",{label:n})}).catch(e=>{setTimeout(()=>{throw e})})},N=e=>aa(j.get(e)),A=({lawfulBasis:e,subscription:s,explanation:t,email:i})=>{const n=aa(j.get(s));c&&Object(o.b)(i,{lawfulBasis:e,legalBasis:e,subscription:s,explanation:t}).then(()=>{De.d("crm_components.GDPR.alerts.addSubscription",{label:n})}).catch(e=>{if(!e.responseJSON)throw e;const{errorType:s}=e.responseJSON;De.b("crm_components.GDPR.errors."+na[s],{label:n,email:i})})},P=()=>{p(!c)},U=e=>{const s=e&&e.size||0,t=Object(Ue.m)(h);return Object(hi.b)(h,m)?Object(i.jsx)(Oi.a,{"data-unit-test":"gdpr-subscriptions-opted-out",children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.optedOut",options:{emailName:t}})}):s?Object(i.jsx)(Oi.a,{"data-selenium-test":"gdpr-current-subscription-button-container",children:Object(i.jsx)(ve.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.totalSubscriptions",options:{name:t,totalSubscriptions:Object(i.jsx)(Q.a,{className:"p-all-0","data-selenium-test":"gdpr-current-subscription-button",onClick:C,children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.subscriptions",options:{count:s}})})}})}):Object(i.jsx)(Oi.a,{children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.emptyState"})})},y=()=>Object(i.jsx)("div",{children:Object(i.jsx)(Q.a,{onClick:I,"data-selenium-test":"gdpr-history-button",children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.subscriptionHistoryButton"})})}),M=e=>Object(i.jsxs)(T.Fragment,{children:[U(e),y()]});if(Object(a.d)(m)||!h)return Object(i.jsx)(ye.a,{});if(!d)return Object(i.jsx)("div",{"data-test-id":"crm-subscriptions-card",children:Object(i.jsx)(li,{appName:"CRM_RECORDS",contactId:h.vid,gates:e.gates,scopes:e.user.scopes,firstName:t,lastName:n,handleSubscribeError:oa,handleUnsubscribeError:oa})});const D=Object(Ue.m)(h);if(!s)return Object(i.jsx)("div",{"data-selenium-test":"gdpr-no-emails",children:Object(i.jsx)(l.a,{message:"cardGDPRSubscriptions.profileSidebarModule.subscriptions.noEmail",options:{name:D}})});if(b)return Object(i.jsx)("div",{"data-test-id":"crm-subscriptions-card",children:Object(i.jsx)(ta,{subjectId:h.get("vid")})});const B=ra(j,m);return Object(i.jsxs)("div",{"data-test-id":"crm-subscriptions-card",children:[M(B),S&&Object(i.jsx)(Ae,{emails:s,handleAddSubscription:r,handleCancel:x,handleClose:f,handleRemoveSubscription:R,handleUpdateSubscription:A,getLabel:N,isAddingSubscription:c,rows:B,subject:h,canEdit:u}),E&&Object(i.jsx)(Ii,{handleUpdateSubscription:A,emails:s,isAddingSubscription:c,handleHistoryClose:_,toggleAddSubscriptionHistory:P,handleCancel:x,isEditable:u,isGloballyOptedOut:Object(hi.b)(h,m)})]})};ca.propTypes=ia;s.default=Object(Be.connect)({subject:Si.a,emails:{stores:[n.a],deref:({subjectId:e})=>{const s=n.a.get(e);return Object(hi.a)(s)}},firstName:{stores:[n.a],deref:({subjectId:e})=>{const s=n.a.get(e);return Object(Ue.g)(s,"firstname")}},lastName:{stores:[n.a],deref:({subjectId:e})=>{const s=n.a.get(e);return Object(Ue.g)(s,"lastname")}},subscriptionsByEmail:{stores:[u.a,n.a],deref:({subjectId:e})=>{const s=n.a.get(e),t=Object(hi.a)(s);if(Object(a.c)(t))return a.a;const i=t.map(e=>u.a.get(e));return i.some(a.d)?a.b:i.filter(di.a)}},subscriptionDefinitionsById:{stores:[c.a],deref(){const e=c.a.get("subscriptionDefinitions")&&c.a.get("subscriptionDefinitions").get("subscriptionDefinitions");return e?e.reduce((e,s)=>e.set(s.get("id"),s),Object(m.Map)()):null}},isUngatedForUpdatedSubscriptionsCard:{stores:[r.default],deref:()=>r.default.get("Subscriptions:UpdatedCRMCard")},isUngatedForPreferencesGroupBeta:{stores:[r.default],deref:()=>r.default.get("subscriptions:groupSettings")}})(ca)},MFUk:function(e,s,t){var i=t("gygT"),n=t("bt+1");function a(e,s,t,r,o){var c=-1,u=e.length;t||(t=n);o||(o=[]);for(;++c<u;){var l=e[c];s>0&&t(l)?s>1?a(l,s-1,t,r,o):i(o,l):r||(o[o.length]=l)}return o}e.exports=a},Qj0O:function(e,s,t){var i=t("MFUk"),n=t("Uq6P"),a=t("jZaD"),r=t("GXF8"),o=a((function(e,s){if(null==e)return[];var t=s.length;t>1&&r(e,s[0],s[1])?s=[]:t>2&&r(s[0],s[1],s[2])&&(s=[s[0]]);return n(e,i(s,1),[])}));e.exports=o},TgAf:function(e,s,t){"use strict";var i=t("oT1v"),n=t("5mx2"),a=t("0dUV"),r=t("AgF4");Object(a.b)({namespace:n.ib,fetch:i.a});const o=Object(a.a)({namespace:n.ib,idIsValid:()=>!0}).defineName("SubscriptionDefinitionsStore").register(r.a);s.a=o},Uq6P:function(e,s,t){var i=t("2yJK"),n=t("XhtK"),a=t("C3JH"),r=t("7vvg"),o=t("qu2x"),c=t("k4Mm"),u=t("Fe4A");function l(e,s,t){var l=-1;s=i(s.length?s:[u],o(n));var b=a(e,(function(e,t,n){return{criteria:i(s,(function(s){return s(e)})),index:++l,value:e}}));return r(b,(function(e,s){return c(e,s,t)}))}e.exports=l},"bt+1":function(e,s,t){var i=t("BEas"),n=t("z4Gd"),a=t("mPI7"),r=i?i.isConcatSpreadable:void 0;function o(e){return a(e)||n(e)||!!(r&&e&&e[r])}e.exports=o},frTQ:function(e,s,t){"use strict";var i=t("Wf03"),n=t("tPYf"),a=t("m9st"),r=t("pq4V"),o=t("Nw75"),c=t("MQNR"),u=t("VfuR"),l=t.n(u),b=t("YP+8"),d=t("zQkm"),p=t("inXk"),O=t("x7mX");const S={[c.COMPANY]:i.a,[c.CONTACT]:a.a,[c.DEAL]:r.a,[c.VISIT]:b.a,[c.TICKET]:d.a},h={propTypes:{objectType:n.b.isRequired,subjectId:l.a.string},stores:[i.a,a.a,p.a,r.a,d.a,b.a],deref(e){const{objectType:s,subjectId:t}=e;if(null===t)return o.a;if(![c.COMPANY,c.CONTACT,c.DEAL,c.VISIT,c.TICKET].includes(s)){const e=Object(O.b)({objectId:t,objectTypeId:s});return p.a.get(e)}const i=S[s];return i&&i.get(t)}};s.a=h},"hEU+":function(e,s,t){"use strict";var i=t("QgEn"),n=t("LTV0"),a=t("FeM/");const r="SidebarLoading",o={minHeight:n.a.propTypes.minHeight},c={minHeight:200},u=({minHeight:e})=>Object(i.jsx)(a.a,{children:Object(i.jsx)(n.a,{grow:!0,minHeight:e})});u.displayName=r;u.propTypes=o;u.defaultProps=c;var l=u;t.d(s,"a",(function(){return l}))},k4Mm:function(e,s,t){var i=t("EFWH");function n(e,s,t){for(var n=-1,a=e.criteria,r=s.criteria,o=a.length,c=t.length;++n<o;){var u=i(a[n],r[n]);if(u){return n>=c?u:u*("desc"==t[n]?-1:1)}}return e.index-s.index}e.exports=n},lkf3:function(e,s,t){"use strict";t.d(s,"a",(function(){return o}));t.d(s,"b",(function(){return c}));var i=t("QYOI"),n=t("E7+s"),a=t("P4dz"),r=t("VukZ");const o=e=>{if(!e)return n.a;const s=Object(a.g)(e,"email"),t=Object(r.e)(e);if(!s)return n.a;const o=[s].concat(t);return Object(i.Set)(o).toArray()},c=(e,s)=>{const t=Object(a.g)(e,"email"),i=s&&s.find(e=>e.get("email")===t);return i&&"unsubscribed"===i.get("status")}},m2rd:function(e,s,t){var i=t("6U43"),n=t("4gww"),a=t("oy6V"),r=1/0,o=i&&1/a(new i([,-0]))[1]==r?function(e){return new i(e)}:n;e.exports=o},qrlA:function(e,s,t){var i=t("p+29"),n=t("O13Z"),a=t("ym/W"),r=t("lfzG"),o=t("m2rd"),c=t("oy6V"),u=200;function l(e,s,t){var l=-1,b=n,d=e.length,p=!0,O=[],S=O;if(t){p=!1;b=a}else if(d>=u){var h=s?null:o(e);if(h)return c(h);p=!1;b=r;S=new i}else S=s?[]:O;e:for(;++l<d;){var j=e[l],m=s?s(j):j;j=t||0!==j?j:0;if(p&&m==m){for(var T=S.length;T--;)if(S[T]===m)continue e;s&&S.push(m);O.push(j)}else if(!b(S,m,t)){S!==O&&S.push(m);O.push(j)}}return O}e.exports=l},sPSZ:function(e,s,t){"use strict";var i=t("al+t"),n=t("5mx2"),a=t("0dUV"),r=t("RRvD"),o=t("QYOI"),c=t("AgF4");Object(a.b)({namespace:n.hb,fetch:i.a});const u=Object(a.a)({namespace:n.hb,idIsValid:e=>"string"==typeof e}).defineName("SubscriptionsStoreByEmail").defineResponseTo(r.SUBSCRIPTION_RELATIONSHIP_FETCH_SUCCEEDED,(e,s)=>e.mergeDeep(s)).defineResponseTo(r.SUBSCRIPTION_RELATIONSHIP_UPDATE_SUCCEEDED,(e,{email:s,updatedSubscription:t})=>{const i=e.getIn([s,"subscriptionStatuses"]).findIndex(e=>e.get("id")===t.id);return i>-1?e.setIn([s,"subscriptionStatuses",i],Object(o.fromJS)(t)):e.updateIn([s,"subscriptionStatuses"],e=>e.push(Object(o.fromJS)(t)))}).defineResponseTo(r.SUBSCRIPTION_RELATIONSHIP_UPDATES_SUCCEEDED,(e,{emails:s,updatedSubscription:t})=>{s.forEach((s="NOT_OPTED",i)=>{t.optState=s;const n=e.getIn([i,"subscriptionStatuses"]).findIndex(e=>e.get("id")===t.id);e=n>-1?e.setIn([i,"subscriptionStatuses",n],Object(o.fromJS)(t)):e.updateIn([i,"subscriptionStatuses"],e=>e.push(Object(o.fromJS)(t)))});return e}).register(c.a);s.a=u},w3lB:function(e,s,t){"use strict";t.d(s,"b",(function(){return n}));t.d(s,"c",(function(){return a}));t.d(s,"a",(function(){return r}));const i=e=>{const s={};let t;if(!(e instanceof Object)||Array.isArray(e))throw new Error("keyMirror(...): Argument must be an object.");for(t in e)e.hasOwnProperty(t)&&(s[t]=t);return s},n=i({LEGITIMATE_INTEREST_PQL:null,LEGITIMATE_INTEREST_CLIENT:null,LEGITIMATE_INTEREST_OTHER:null,PERFORMANCE_OF_CONTRACT:null,CONSENT_WITH_NOTICE:null,NON_GDPR:null}),a=i({LEGITIMATE_INTEREST_PQL:null,LEGITIMATE_INTEREST_CLIENT:null,LEGITIMATE_INTEREST_OTHER:null,PERFORMANCE_OF_CONTRACT:null,CONSENT_WITH_NOTICE:null,NON_GDPR:null}),r=(i({OPT_IN:null,OPT_OUT:null,NOT_OPTED:null}),i({subscription:null,newStatus:null,email:null,lawfulBasis:null,legalBasis:null,explanation:null,requestedBy:null,source:null,created:null}))}}]);
//# sourceMappingURL=default~sidebar-gdpr.js.map
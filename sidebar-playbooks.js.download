(window.webpackJsonp=window.webpackJsonp||[]).push([["sidebar-playbooks"],{"/rZr":function(e,t,o){"use strict";var a=o("VfuR"),s=o.n(a),n=o("9f1P"),r=o.n(n),c=o("bKOC"),i=o("+KD7");const l=(e="right")=>Object(n.css)(["border-radius:",";box-shadow:0 1px 2px rgba(0,0,0,0.2);padding:",";"],"right"===e?"20px 6px 6px 20px":"6px 20px 20px 6px","right"===e?"0 6px 0 10px":"0 10px 0 6px");var d=o("F2UM");const p=Object.assign({},c.a,{pantera:i.PANTERA,koala:i.KOALA,beta:i.THUNDERDOME,free:i.LORAX,new:i.OZ}),u=Object.keys(p),b="new",y=({use:e})=>{if(!e)return"";const t=p[e]||p[b];return Object(n.css)(["background-color:",";color:",";"],t,t===i.KOALA?i.OBSIDIAN:i.OLAF)},m=r.a.span.withConfig({displayName:"UIRibbon",componentId:"k46o23-0"})(["",";",";",";position:absolute;top:8px;",";z-index:1;"],d.a,y,({position:e})=>l(e),({position:e})=>"right"===e?"right: -4px":"left: -4px");m.propTypes={position:s.a.oneOf(["left","right"]).isRequired,children:s.a.node,use:s.a.oneOf(u).isRequired};m.defaultProps={position:"right",use:b};m.displayName="UIRibbon";t.a=m},"06Wo":function(e,t,o){"use strict";o.r(t);o.d(t,"PlaybooksCardActionsDynamic",(function(){return d}));o.d(t,"PlaybooksCardActions",(function(){return p}));var a=o("QgEn"),s=o("DqRu"),n=o("nDpY"),r=o.n(n),c=o("sl/w"),i=o("Ktcs"),l=o("qvRI");const d=()=>{const e=`/playbooks/${r.a.get()}/`,t=Object(i.useCallback)(()=>{l.a.log("playbookInteraction",{action:"manage-playbook-card",playbookId:0,playbookType:""})},[]);return Object(a.jsx)(s.a,{href:e,onClick:t,use:"link",children:Object(a.jsx)(c.a,{message:"cardPlaybooks.playbooksIndex.actions.managePlaybook"})})},p=()=>Object(a.jsx)(d,{});t.default=p},"9UnH":function(e,t,o){"use strict";o.r(t);var a=o("QgEn"),s=o("sl/w"),n=o("3qbZ"),r=o("DqRu"),c=o("QvWB"),i=o("VQUG"),l=o("FeM/");function d(){const{openUpgradeModal:e}=Object(n.a)("playbooks-record-card");return Object(a.jsxs)(i.a,{align:"center",direction:"column",children:[Object(a.jsx)(l.a,{children:Object(a.jsx)(s.a,{message:"cardPlaybooks.profileSidebarModule.playbooksModule.zeroState.text"})}),Object(a.jsxs)(r.a,{use:"tertiary-light",size:"small",onClick:e,children:[Object(a.jsx)(s.a,{message:"cardPlaybooks.profileSidebarModule.playbooksModule.actions.pqlButton"}),Object(a.jsx)(c.a,{name:"locked"})]})]})}var p=o("3CFq"),u=o("VfuR"),b=o.n(u),y=o("yIhL");const m=6;function j({searchQuery:e,totalCount:t,onPageChange:o}){const{offset:s,limit:n}=e,r=Math.ceil(t/n),c=s/n+1;return Object(a.jsx)(y.a,{className:"p-top-4",maxVisiblePageButtons:m,page:c,pageCount:r,onPageChange:o})}j.propTypes={onPageChange:b.a.func.isRequired,totalCount:b.a.number.isRequired,searchQuery:b.a.object.isRequired};var g=o("+XVW"),O=o("77dM"),f=o("EIJv");const k=({query:e})=>{const t=""===e?"noPlaybooksCreated":"search";return Object(a.jsx)(s.a,{message:"cardPlaybooks.playbooksIndex.emptyState."+t,className:"p-top-1"})};k.propTypes={query:b.a.string};var h=k,x=o("+KD7"),P=o("oxA8"),T=o("dKJf"),I=o("npjq");function L({timesViewed:e,lastViewedAt:t}){return Object(a.jsxs)(T.a,{"data-selenium-test":"playbooks-list-item-details",children:[Object(a.jsx)(P.a,{message:"cardPlaybooks.playbooksIndex.usageDetails.timesViewed",options:{timesViewed:e}}),t?Object(a.jsxs)("span",{children:[Object(a.jsx)("span",{className:"m-x-1",children:"â€¢"}),Object(a.jsx)(P.a,{message:"cardPlaybooks.playbooksIndex.usageDetails.lastViewedAt",options:{lastViewedAt:I.a.moment.userTz(t).fromNow()}})]}):null]})}var E=o("5qWo"),C=o("/rZr"),R=o("G2Xo");function w({recommendationType:e}){switch(e){case"RULE":return Object(a.jsxs)(C.a,{use:"lorax",title:Object(R.a)("cardPlaybooks.playbookCard.recommended"),children:[Object(a.jsx)(c.a,{name:"bulb"})," ",Object(a.jsx)(s.a,{message:"cardPlaybooks.playbookCard.recommended"})]});case"FREQUENTLY_USED":return Object(a.jsxs)(C.a,{use:"candy-apple",title:Object(R.a)("cardPlaybooks.playbookCard.frequentlyUsed"),children:[Object(a.jsx)(c.a,{name:"refresh"})," ",Object(a.jsx)(s.a,{message:"cardPlaybooks.playbookCard.frequentlyUsed"})]});case"RECENTLY_USED":return Object(a.jsxs)(C.a,{use:"calypso",title:Object(R.a)("cardPlaybooks.playbookCard.recentlyUsed"),children:[Object(a.jsx)(c.a,{name:"recentlySelected"})," ",Object(a.jsx)(s.a,{message:"cardPlaybooks.playbookCard.recentlyUsed"})]});default:return null}}function v({isLoading:e,result:t,isError:o,searchText:n,onClickPlaybook:r}){return 0===t.total||o?o?Object(a.jsx)(s.a,{message:"cardPlaybooks.playbooksIndex.error",className:"p-top-1"}):Object(a.jsx)("div",{children:Object(a.jsx)(h,{query:n})}):Object(a.jsxs)(i.a,{direction:"column",align:"stretch","data-selenium-test":"playbooks-list",style:{position:"relative"},children:[t.results.map(e=>{const{playbook:t,recommendationType:o}=e,{contentId:s,name:n}=t;return Object(a.jsxs)(g.a,{className:"m-x-0 m-y-1",selected:!1,block:!1,flush:!0,onClick:()=>{r(e)},style:{borderColor:x.GREAT_WHITE},"data-selenium-test":"playbooks-list-item",children:[Object(a.jsx)(w,{recommendationType:o}),Object(a.jsxs)(i.a,{className:"p-x-4 p-y-3",justify:"start",direction:"column",children:[Object(a.jsx)(O.a,{className:"text-left",style:{fontSize:14,fontWeight:500},children:Object(a.jsx)(f.a,{children:n})}),t.metadata.usageDetails&&Object(a.jsx)(L,{lastViewedAt:t.metadata.usageDetails.lastViewedAt,timesViewed:t.metadata.usageDetails.timesViewed})]})]},"playbookButton."+s)}),e&&Object(a.jsx)(E.a,{contextual:!0})]})}function A({state:e,actions:t}){return Object(a.jsxs)(i.a,{direction:"column",align:"stretch","data-test-id":"playbook-card-list","data-loading":e.loading,children:[Object(a.jsxs)(i.a,{align:"stretch",direction:"column",children:[e.hasQueryOrResults&&Object(a.jsx)(p.a,{className:"m-bottom-1",onChange:t.onSearchInputChange}),e.showRecommendations&&Object(a.jsx)(v,{isError:!1,isLoading:e.loading,onClickPlaybook:t.openPlaybookModal,result:e.recommendationResult,searchText:e.searchText}),e.showAllPlaybooks&&Object(a.jsx)(v,{isError:e.failedToLoad,isLoading:e.loading,onClickPlaybook:t.openPlaybookModal,result:e.playbooksResult,searchText:e.searchText})]}),e.showPaginator&&Object(a.jsx)(j,{searchQuery:e.searchQuery,totalCount:e.totalPlaybooksCount,onPageChange:t.handlePageChange}),!e.showAllPlaybooks&&Object(a.jsx)(r.a,{use:"link",className:"p-top-2",onClick:t.showAllPlaybooks,"data-test-id":"playbook-card-view-all-playbooks",children:Object(a.jsx)(s.a,{message:"cardPlaybooks.playbookCard.viewAllPlaybooks"})})]})}var S=o("qvRI"),_=o("xA3K"),N=o("g+dq"),q=o.n(N);const D={filters:[{field:"content_type",values:["PLAYBOOK"]},{field:"publication_stage",values:["PUBLISHED","PUBLISHED_WITH_EDITS"]}],limit:3,offset:0,query:"",sorts:[{field:"updated_at",order:"DESC"}]};function M(e){let{query:t}=e,o=Object(_.a)(e,["query"]);return q.a.post("playbooks/v1/recommendations/content-search",{query:o,data:Object.assign({contentTypesToHydrate:["PLAYBOOK"]},D,{},t)})}var U=o("GgP/"),V=o("+rxA"),F=o("pCbF"),K=o("6L7K"),B=o("Ktcs");function Q(e){const t=e+"_pending",o=e+"_fulfilled",a=e+"_rejected";return function(){function e(e){return{type:t,payload:e}}e.type=t;function s(e){return{type:o,payload:e}}s.type=o;function n(e){return{type:a,payload:e}}n.type=a;return{pending:e,fulfilled:s,rejected:n}}}const Y=Q("FETCH_PLAYBOOKS")(),H=Q("FETCH_RECOMMENDED_PLAYBOOKS")(),W=Q("FETCH_PLAYBOOKS_WITH_RECOMMENDATIONS")(),Z=e=>({type:"SWITCH_TO_CARDLIST_VIEW",view:e});var J=o("mEYk"),z=o.n(J);const G=({objectTypeId:e,objectId:t,searchText:o,offset:a})=>(s,n,r)=>{const c=r.playbookListLimit,i=void 0===o?n().searchText:o;s(W.pending({offset:a,searchText:i,limit:c}));return r.searchPlaybooksWithRecommendations({objectId:t,objectTypeId:e,query:{limit:c,offset:a,query:i},shouldHoistRecommendations:0===a&&0===i.length}).then(e=>s(W.fulfilled(e))).catch(e=>{z.a.captureException(e);s(W.rejected(e))})},X={loading:!0,playbooks:{offset:0,results:[],total:0,hoistedRecommendations:[]},requestedPlaybooks:{offset:0},searchText:"",searchFailed:!1,recommendationsFailed:!1,cardListView:"ALL_PLAYBOOKS"};function $(e,t){switch(t.type){case Y.pending.type:return Object.assign({},e,{requestedPlaybooks:{offset:t.payload.offset},searchText:t.payload.searchText,loading:!0});case H.pending.type:return Object.assign({},e,{loading:!0});case H.fulfilled.type:return Object.assign({},e,{loading:!1,playbooks:Object.assign({},e.playbooks,{hoistedRecommendations:t.payload.map(e=>({recommendationType:"RULE",playbook:e}))})});case Y.fulfilled.type:return Object.assign({},e,{loading:!1,playbooks:Object.assign({},t.payload,{hoistedRecommendations:e.playbooks.hoistedRecommendations,results:t.payload.results.map(e=>({recommendationType:"NONE",playbook:e}))})});case Y.rejected.type:return Object.assign({},e,{searchFailed:!0,loading:!1});case H.rejected.type:return Object.assign({},e,{recommendationsFailed:!0,loading:!1});case W.pending.type:return Object.assign({},e,{requestedPlaybooks:{offset:t.payload.offset},searchText:t.payload.searchText,cardListView:t.payload.searchText.length>0?"ALL_PLAYBOOKS":e.cardListView,loading:!0});case W.fulfilled.type:return Object.assign({},e,{playbooks:t.payload,cardListView:0===t.payload.hoistedRecommendations.length?"ALL_PLAYBOOKS":e.cardListView,loading:!1});case W.rejected.type:return Object.assign({},e,{recommendationsFailed:!0,searchFailed:!0,loading:!1});case"SWITCH_TO_CARDLIST_VIEW":return Object.assign({},e,{cardListView:t.view});default:return e}}var ee=o("+yfp"),te=o.n(ee);function oe(e,t){const o=Object(B.useRef)(t);o.current=t;const a=Object(B.useMemo)(()=>te()(e,(...e)=>o.current(...e)),[e]);Object(B.useEffect)(()=>()=>{a.cancel()},[a]);return a}function ae(e,t,o){const a=Object(B.useRef)(e);a.current=e;return Object(B.useCallback)((function e(s){if("function"==typeof s)return s(e,()=>a.current,o);t(s)}),[t,o])}const se=e=>e.scopes.includes("playbooks-read"),ne=Object.assign({},X,{cardListView:"RECOMMENDATIONS_ONLY"});function re({service:e,objectType:t,objectId:o}){const[a,s]=Object(B.useReducer)($,ne),n=ae(a,s,e),r=oe(350,a=>{n(G({objectTypeId:t,objectId:o,searchText:a,offset:0}));e.logInteraction("playbookInteraction",{action:"search-card",playbookId:0,playbookType:""})}),c=Object(B.useMemo)(()=>({fetch(){n(G({objectTypeId:t,objectId:o,searchText:"",offset:0}))},handlePageChange({target:{value:a}}){const s=(a-1)*e.playbookListLimit;n(G({objectTypeId:t,objectId:o,offset:s}))},onSearchInputChange(e){r(e.currentTarget.value)},openPlaybookModal(t){const{playbook:o,recommendationType:a}=t;e.openPlaybook(o.contentId);e.logInteraction("playbookInteraction",{playbookId:o.contentId,playbookType:o.metadata.playbookType,action:"opened "+("NONE"!==a?"recommended playbook":"playbook"),what_value_str:a})},showAllPlaybooks(){s(Z("ALL_PLAYBOOKS"))}}),[n,t,o,r,e]);Object(B.useEffect)(()=>{se(e)&&c.fetch()},[c,e]);return[Object(B.useMemo)(()=>{const t=a.playbooks.total,o=!1,s=a.searchText.length>0,n=a.playbooks,{hoistedRecommendations:r}=n,c=Object(_.a)(n,["hoistedRecommendations"]),i=r.length>0,l=0===a.requestedPlaybooks.offset,d=!s&&i&&l,p="ALL_PLAYBOOKS"===a.cardListView;return{hasQueryOrResults:s||0!==t,showRecommendations:d,showPaginator:t>e.playbookListLimit&&!o&&p,loading:a.loading,recommendationResult:{total:r.length,offset:0,results:r},playbooksResult:c,searchText:a.searchText,searchQuery:{offset:a.requestedPlaybooks.offset,limit:e.playbookListLimit},totalPlaybooksCount:t,failedToLoad:a.searchFailed,isEnabledForPlaybooks:se(e),showAllPlaybooks:p}},[a,e]),c]}o.d(t,"crmPlaybooksService",(function(){return ce}));o.d(t,"default",(function(){return ie}));const ce={logInteraction:(...e)=>S.a.log(...e),get scopes(){return Object(U.userInfoSync)().user.scopes},playbookListLimit:3,openPlaybook:e=>{Object(V.b)(""+e);Object(F.default)(!0)},searchPlaybooksWithRecommendations:M};function ie(){const{objectType:e,objectId:t}=Object(B.useContext)(K.a),[o,s]=re({service:ce,objectType:e,objectId:t});return o.isEnabledForPlaybooks?Object(a.jsx)(A,{state:o,actions:s}):Object(a.jsx)(d,{})}},Njsu:function(e,t,o){"use strict";var a=o("7OzJ"),s=o("LZPL"),n=o.n(s),r=o("pG/d"),c=o("QZXc"),i=o.n(c),l=o("JadZ"),d=o("5BKn");const p={properties:{namespace:a.g},onError(e){console.error(e)},lastKnownEventProperties:["screen","subscreen"],debug:()=>n.a.debug("customer-data-tracker")},u=Object(l.a)(()=>Object(r.a)(Object.assign({},p,{events:i()}))),b=Object(l.a)(()=>Object(r.a)(Object.assign({isBeforeUnload:!0,events:i()},p))),y={init:e=>{u().setProperties(e);b().setProperties(e)},logImmediate:(e,t={},o={})=>{y.log(e,t,Object.assign({},o,{sendImmediate:!0}))},log:(e,t={},o={sendImmediate:!1})=>{y._log(e,t,o)},_log(e="",t={},o={sendImmediate:!1}){d.a.track(e,t,o,u(),b())}};t.a=y},QZXc:function(e,t){e.exports={embeddedReportView:{name:"embedded report view",class:"view",properties:{action:"string",subscreen2:{type:"string",isOptional:!0}},namespace:"reporting"},embeddedReportInteraction:{name:"embedded report interaction",class:"interaction",properties:{action:"string",value:{type:"string",isOptional:!0},subscreen2:{type:"string",isOptional:!0}},namespace:"reporting"}}},UVNQ:function(e,t,o){"use strict";o.r(t);o.d(t,"PlaybooksCardTitle",(function(){return c}));var a=o("QgEn"),s=o("VfuR"),n=o.n(s),r=o("sl/w");const c=({data:e})=>Object(a.jsx)(r.a,{message:"cardPlaybooks.profileSidebarModule.playbooksModule.titleNoCount"});c.propTypes={data:n.a.object};t.default=c},hYtw:function(e,t){e.exports={productPanelUsage:{name:"Product panel",properties:{action:["Create product","Edit product"],subAction:["Save","Save and add another"],propertyName:{type:"string"}},namespace:"products",class:"usage"},productExport:{name:"Products export",properties:{action:["Export success"],subAction:["Export specific objects","Export all objects"],containsSearchQuery:{type:"boolean"}},namespace:"products",class:"usage"},deleteObject:{properties:{action:["Delete product","Delete folder"]},namespace:"products",name:"Products usage",class:"usage"},bulkDeleteObjects:{properties:{action:["Bulk delete"],containsSearchQuery:{type:"boolean"}},namespace:"products",name:"Products usage",class:"usage"},modifyFolderModal:{properties:{action:["Create folder","Edit folder"]},namespace:"products",name:"Products usage",class:"usage"},moveProductToFolder:{properties:{action:["Move product to folder"]},namespace:"products",name:"Products usage",class:"usage"},openProductOrLineItemPanel:{properties:{action:["create","edit","view"],objectType:["PRODUCT","LINE_ITEM"],sourceIsShopify:"boolean",sourceIsEcommBridge:{type:"boolean",isOptional:!0}},namespace:"products",name:"Products interaction",class:"interaction"},toggleFilePickerForImageURL:{properties:{action:["Open file picker for image URL","Close file picker for image URL"],objectType:["PRODUCT","LINE_ITEM"]},namespace:"products",name:"Products interaction",class:"interaction"},selectFileForImageURL:{properties:{action:["Select file for image URL"],objectType:["PRODUCT","LINE_ITEM"]},namespace:"products",name:"Products interaction",class:"interaction"},productLibraryFilter:{properties:{action:["Filter product library"]},namespace:"products",name:"Products interaction",class:"interaction"}}},qvRI:function(e,t,o){"use strict";var a=o("0xjy"),s=(o("3cdJ"),o("Iw5m")),n=(o("iIyW"),o("7OzJ")),r=o("LZPL"),c=o.n(r),i=o("pG/d"),l=o("hYtw"),d=o.n(l),p=o("JadZ");o("5BKn");const u={properties:{namespace:n.e},onError(e){console.error(e)},lastKnownEventProperties:["screen","subscreen"],debug:()=>c.a.debug("customer-data-tracker")};Object(p.a)(()=>Object(i.a)(Object.assign({events:d.a},u))),Object(p.a)(()=>Object(i.a)(Object.assign({isBeforeUnload:!0,events:d.a},u)));o("FH5t"),o("Njsu"),o("MdlO");o.d(t,"a",(function(){return a.a}));o.d(t,"b",(function(){return s.a}))}}]);
//# sourceMappingURL=sidebar-playbooks.js.map
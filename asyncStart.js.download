!function(e){var t={};function n(s){if(t[s])return t[s].exports;var o=t[s]={i:s,l:!1,exports:{}};e[s].call(o.exports,o,o.exports,n);o.l=!0;return o.exports}n.m=e;n.c=t;n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})};n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});Object.defineProperty(e,"__esModule",{value:!0})};n.t=function(e,t){1&t&&(e=n(e));if(8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);n.r(s);Object.defineProperty(s,"default",{enumerable:!0,value:e});if(2&t&&"string"!=typeof e)for(var o in e)n.d(s,o,function(t){return e[t]}.bind(null,o));return s};n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};n.d(t,"a",t);return t};n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};n.p="//static.hsappstatic.net/calling-cross-tab-messaging/static-1.7976/";n(n.s=2)}([function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));n.d(t,"b",(function(){return o}));function s(){return"undefined"!=typeof window&&window||void 0!==e&&e||{}}function o(){return s().hubspot=s().hubspot||{}}}).call(this,n(1))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);function s(e,t,n){let s;const o=n||{};try{s=new CustomEvent(e,{detail:o})}catch(t){s=document.createEvent("CustomEvent");s.initCustomEvent(e,!1,!1,o)}t.dispatchEvent(s)}const o="CALLING_CROSS_TAB_DEPENDENCIES_LOADED",i=()=>{s(o,window)};class r extends Error{constructor({message:e,criticalFailure:t,details:n}){super(e);this.details={};this.name="CallingCrossTabClientError";"captureStackTrace"in Error&&Error.captureStackTrace(this,this.constructor);this.details=n||{};this.criticalFailure=Boolean(t)}}function a(e,t={},n="error"){if("function"==typeof console.group){console.groupCollapsed(`%c ${e.name||"UnknownError"} ${n.toUpperCase()} %c`,`background-color:#${"error"===n?"c51212":"516f90"};color:white;padding:.15em .25em`,"color:#33475b",e.message);console.log("Message: "+e.message);console.log(t);console.error(e);console.groupEnd()}}const c={level:"error",tags:{},extra:{},fingerprint:[]},u=(e,t={})=>{const n=Object.assign({},c,{},t),s=window.newrelic&&window.newrelic.noticeError;"function"==typeof s&&"error"===n.level&&s(e,n.tags);window.Raven&&window.Raven.captureException&&window.Raven.captureException(e,n);a(e,n.extra,n.level)};let l,d;!function(e){e.UNINITIALIZED="UNINITIALIZED";e.STARTED="STARTED";e.SUCCEEDED="SUCCEEDED";e.FAILED="FAILED";e.DEPRECATED="DEPRECATED";e.UNSUPPORTED="UNSUPPORTED"}(l||(l={}));!function(e){e.UNINITIALIZED="UNINITIALIZED";e.LOADING="LOADING";e.READY="READY";e.INITIALIZING_OUTBOUND_CALL="INITIALIZING_OUTBOUND_CALL";e.INCOMING_INBOUND_CALL="INCOMING_INBOUND_CALL";e.RINGING="RINGING";e.ANSWERED="ANSWERED";e.ENDING="ENDING";e.ENDED="ENDED";e.SYNC_TIMEOUT="SYNC_TIMEOUT"}(d||(d={}));d.UNINITIALIZED,d.LOADING,d.READY,d.INITIALIZING_OUTBOUND_CALL,d.INCOMING_INBOUND_CALL,d.RINGING,d.ANSWERED,d.ENDING,d.ENDED,d.SYNC_TIMEOUT;const h=(e="")=>{let t,n="";for(let e=0;e<32;e++){t=16*Math.random()|0;8!==e&&12!==e&&16!==e&&20!==e||(n+="-");n+=(12===e?4:16===e?3&t|8:t).toString(16)}return`${e}_${n}`};let p,g;!function(e){e.NONE="NONE";e.FETCH_TOKEN_ERROR="FETCH_TOKEN_ERROR"}(p||(p={}));!function(e){e.CURRENT="0.0.9";e["0.0.8"]="0.0.8";e["0.0.7"]="0.0.7"}(g||(g={}));const m=g.CURRENT,E="calling",f=h(),D=()=>({version:m,deprecated:!1,widgetDetails:{uuid:f,callStatus:d.READY,activeCallDetails:void 0,standaloneConnectionId:void 0,deviceErrorCode:void 0,criticalFailureReason:p.NONE}});let _;!function(e){e.UNINITIALIZED="UNINITIALIZED";e.STARTED="STARTED";e.SUCCEEDED="SUCCEEDED";e.FAILED="FAILED"}(_||(_={}));const b=()=>{const e=D();return{version:e.version,deprecated:e.deprecated,widgetDetails:Object.assign({},e.widgetDetails,{uuid:_.FAILED})}},y=e=>e?e.deprecated?l.DEPRECATED:l.SUCCEEDED:l.FAILED,I="CALLING_APP_DATA_UPDATE";let A;!function(e){e.APP_DATA_UPDATE="APP_DATA_UPDATE";e.APP_DATA_UPDATED="APP_DATA_UPDATED";e.BROADCAST="BROADCAST";e.FROM_WORKER="FROM_WORKER";e.TO_WORKER="TO_WORKER";e.TO_SERVICE_WORKER="TO_SERVICE_WORKER"}(A||(A={}));function w(e){return e&&e.metadata&&e.metadata.messageRelayType===A.APP_DATA_UPDATED}function T(e){return e&&e.metadata&&e.metadata.messageRelayType===A.BROADCAST}const S=e=>e&&e.type&&e.id&&e.metadata&&e.metadata.messageRelayType&&e.metadata.messageRelayType in A;function C(){let e=()=>{},t=()=>{};return{promise:new Promise((n,s)=>{e=n;t=s}),resolve:e,reject:t}}var N=C;function R({promise:e,attempts:t,delay:n}){return new Promise((s,o)=>{let i;(function r(){0===t?o(i):e().then(s).catch(e=>{t--;i=e;setTimeout(()=>{r()},n)})})()})}const O=e=>"__shared-worker-versioning-embed-message--"+e,v=e=>({format:O(e),id:h(e)});let M;!function(e){e.TO_EMBED="TO_EMBED";e.FROM_EMBED="FROM_EMBED";e.EMBED_READY="EMBED_READY";e.EMBED_INIT_FAILED="EMBED_INIT_FAILED";e.EMBED_WORKER_CONNECTION_STATUS_UPDATE="EMBED_WORKER_CONNECTION_STATUS_UPDATE"}(M||(M={}));const U=(e,t)=>{const n=O(t);return Boolean(e&&e.id&&e.format===n)},P=e=>Boolean(e.type&&e.type===M.FROM_EMBED),L=e=>e.type&&e.type===M.EMBED_READY,j=e=>e.type&&e.type===M.EMBED_INIT_FAILED,B=e=>e&&e.type&&e.type===M.EMBED_WORKER_CONNECTION_STATUS_UPDATE,G=(e,t)=>Object.assign({},v(e),{type:M.TO_EMBED,message:t});function $(e){return e+"-shared-worker-versioning-embed"}function x(e){const t=document.querySelector("body"),n=document.getElementById($(e));n&&t&&t.removeChild(n)}function F(e,t){const n="connectionId="+t;return e.includes("?")?`${e}&${n}`:`${e}?${n}`}function W(e,t,n){const s=document.createElement("iframe");s.id=$(n);s.src=F(e,t);s.style.top="0px";s.style.height="0px";s.style.width="0px";s.style.display="none";s.style.position="fixed";const o=document.querySelector("body");o&&o.appendChild(s);return s}function k(e,t){const n=setTimeout(()=>{const n=new Error(`Expected reply message ${t.responseRequest.type} in response to ${t.type}, reply exceeded response time of 30s`);e(n)},3e4);return(...t)=>{clearTimeout(n);e(...t)}}class q{constructor(){this.queue=[];this.add=e=>{this.queue.push(e)};this.concat=e=>{this.queue=this.queue.concat(e.queue);e.clear()};this.flush=e=>{this.queue.forEach(([t,n])=>e(t,n));this.clear()};this.clear=()=>{this.queue=[]}}getHasQueuedMessages(){return Boolean(this.queue.length)}}function H(){return new q}class Q{constructor(){this.messageQueue=H();this.isEmbedConnected=!1;this.responseMessageQueue={};this.flushEmbedMessageQueue=()=>{this.messageQueue.flush(this.postMessage)};this.hasEmbed=()=>Boolean(this.embedElement&&this.embedElement.contentWindow);this.isConnectionReady=()=>this.hasEmbed()&&this.isEmbedConnected;this.postMessage=e=>{this.embedElement&&this.embedElement.contentWindow&&this.embedElement.contentWindow.postMessage(e,this.embedElement.src)}}}const K=/(?:(?:app(?:-[a-z]{0,2}\d)?)|(?:local))\.hubspot(?:qa)?\.com/;class z{constructor(e){this.messageUtility=new Q;this._initDeferred=N();this.sendMessage=(e,t)=>{const n=G(this._options.embedName,e);if(this.messageUtility.isConnectionReady()){t&&e&&e.responseRequest&&e.responseRequest.type&&(this.messageUtility.responseMessageQueue[e.id]=k(t,e));this.messageUtility.postMessage(n)}else this.messageUtility.messageQueue.add([n,t])};this._handleEmbedReadyMessage=(e,t)=>{if(e.payload){this._options.logClientDebug("Received message from embed "+e.type,e);this.messageUtility.embedElement=t;clearTimeout(this._embedSyncTimeout);this.messageUtility.isEmbedConnected=!0;this._initDeferred.resolve(e);this._options.onEmbedReadyMessage(e)}else this._initDeferred.reject(new Error("Embed Ready message is missing a payload"))};this._handleConnectionStatusUpdateMessage=e=>{if("function"==typeof this._options.onWorkerStatusUpdateMessage){const{type:t}=e;this._options.logClientDebug("Received message from embed "+t,e);this._options.onWorkerStatusUpdateMessage(e)}};this._handleFromEmbedMessage=e=>{const{type:t,responseRequest:n}=e;this._options.logClientDebug("Received message from embed "+t,e);if(e&&n&&n.requestId&&"function"==typeof this.messageUtility.responseMessageQueue[n.requestId]){this.messageUtility.responseMessageQueue[n.requestId](e);delete this.messageUtility.responseMessageQueue[n.requestId]}else this._options.onEmbedMessage(e)};this._handleMessageEvent=(e,t)=>{if(!t.origin.match(K)||!U(t.data,this._options.embedName))return;const{data:n}=t;j(n)?this._initDeferred.reject(n.payload||new Error("Embed failed to initialize")):L(n)?this._handleEmbedReadyMessage(n,e):P(n)?this._handleFromEmbedMessage(n.message):B(n)&&this._handleConnectionStatusUpdateMessage(n)};this.connectToWorkerHost=e=>{e.onload=()=>{this._embedSyncTimeout=setTimeout(()=>{this._initDeferred.reject(new Error("Embed load timeout"))},3e4)};return this._initDeferred.promise};this.reset=()=>{clearTimeout(this._embedSyncTimeout);if(this._currentMessageEventHandler){window.removeEventListener("message",this._currentMessageEventHandler);this._currentMessageEventHandler=void 0}this._initDeferred=N();this.messageUtility.embedElement=void 0;x(this._options.embedName)};this._initializeMessageClient=()=>{const e=W(this._options.embedUrl,this._options.connectionId,this._options.embedName);this._currentMessageEventHandler=this._handleMessageEvent.bind(this,e);window.addEventListener("message",this._currentMessageEventHandler);return this.connectToWorkerHost(e).catch(e=>{this.reset();throw e})};this._options=e}initialize(){return R({promise:this._initializeMessageClient,attempts:1,delay:500}).then(e=>{this.messageUtility.flushEmbedMessageQueue();return e})}}let Y;!function(e){e.STANDALONE_CALLING_APP="STANDALONE_CALLING_APP";e.EXTERNAL="EXTERNAL"}(Y||(Y={}));function Z(e){let t,n=!1;return function(...s){if(!n){n=!0;t=e.apply(this,s)}return t}}const J=Z(()=>{window&&window.callingWidgetConfiguration||(window.callingWidgetConfiguration={broadcastMessageHandlers:[],isLoadingStarted:!1});const e=window.callingWidgetConfiguration;e.broadcastMessageHandlers||(e.broadcastMessageHandlers=[]);void 0===e.isLoadingStarted&&(e.isLoadingStarted=!1);e.connectionId||(e.connectionId=h("callingConnectionId"));e.connectionType||(e.connectionType=Y.EXTERNAL);return window.callingWidgetConfiguration}),V="DEBUG_CALLING_SHARED_WORKER",X={messageDebug:!1,localEmbed:!1};let ee=!1;const te=()=>{if(ee)return X;ee=!0;try{if(localStorage&&"true"===localStorage.getItem(V)){X.messageDebug=!0;X.localEmbed=!0;return X}const e=localStorage&&JSON.parse(localStorage.getItem(V)||"{}");if(e){const{messageDebug:t,localEmbed:n}=e;X.messageDebug=!0===t;X.localEmbed=!0===n}return X}catch(e){return X}};function ne(e,t){return`${encodeURIComponent(e)}=${encodeURIComponent(null==t?"":t)}`}function se(e,t){return t.reduce((t,n)=>{null!=n&&t.push(ne(""+e,n));return t},[]).join("&")}const oe=e=>null==e?"":"string"==typeof e||e instanceof String?e:Object.keys(e).reduce((t,n)=>{const s=e[n];Array.isArray(s)?s.length>0&&t.push(se(n,s)):null!=s&&t.push(ne(n,s));return t},[]).join("&"),ie=["api","local","app","private","platform","tools","meetings"],re=["hubspotstarter","hubspotfree"],ae=["growth"],ce={com:["hubspot","hubteam","grader","getsignals","getsidekick","gettally","hubspotemail","customer-hub","hubspotservicehub","hubspotquote"].join("|"),net:re.join("|"),org:ae.join("|")};var ue=function e(t){const n=new RegExp(`^(?!local|test|selenium)(.*\\.)?(${Object.entries(ce).map(([e,t])=>`(?:${t})(qa)?\\.${e}`).join("|")}|(?:connect)\\.com|(?:connect)(qa)\\.co)$`).test(t.hostname),s=new RegExp(Object.entries(ce).map(([e,t])=>`(?:${t})qa\\.${e}`).join("|")+"|(?:connect)qa\\.co"),o=new RegExp(`^(?:${ie.join("|")})-(.*).(?:hubspot|hubteam)(?:qa)?.com`),i=new RegExp("^(.*).(?:hubspotquote)(?:qa)?.com"),r="ENV",a="Enviro error: the default argument for .get and .getShort is no longer supported",c=e=>{let t=window[e];if(null==t)try{t=window.sessionStorage.getItem(e)}catch(e){}if(null==t)try{t=window.localStorage.getItem(e)}catch(e){}return t},u=()=>{const e=c(r);return e||(s.test(t.host)?"qa":"prod")},l=(e,t)=>{window[e]=t;return t},d={prod:"production",qa:"development"},h=e=>{if("string"==typeof e){const t=e.toLowerCase();return d[t]||t}return e},p=e=>{e="string"==typeof e?e.toLowerCase():void 0;return Object.keys(d).find(t=>e===d[t])||e},g=(e,t)=>{if(null!=t)throw new Error(a);let n=null;if(e){const t=e.split(".").reverse();for(let e=0;e<t.length;e++){const s=t[e];n=c(s.toUpperCase()+"_ENV");if(n)break}}if(null==n){const e=u();n=null!=e?e:"qa"}return h(n)},m=(e,t)=>{if(null!=t)throw new Error(a);return p(g(e))},E=m,f=e=>"prod"===E(e),D=e=>"qa"===E(e);return{createEnviro:e,debug:(e,t=!1)=>{let n;"string"==typeof e&&(n=c(e.toUpperCase()+"_DEBUG"));null==n&&(n=c("DEBUG"));return null==n?t:n},denormalize:p,deployed:e=>{let t;"string"==typeof e&&(t=c(e.toUpperCase()+"_DEPLOYED"));null==t&&(t=c("DEPLOYED"));return null==t?n:!!t},enabled:(e,t=!1)=>{let n=c(e.toUpperCase()+"_ENABLED");null==n&&(n=JSON.stringify(t));return"true"===(""+n).toLowerCase()},get:g,getHublet:()=>{const e=c("HUBLET");return e||(o.test(t.hostname)?o.exec(t.hostname)[1]:i.test(t.hostname)?i.exec(t.hostname)[1]:"na1")},getInternal:m,getShort:E,isProd:f,isQa:D,normalize:h,set:function(e,t){if(1===arguments.length){t=e;e=r}return l(e,t)},setDebug:(e,t=!0)=>{if("string"==typeof e)try{t?localStorage.setItem(e.toUpperCase()+"_DEBUG",JSON.stringify(!0)):localStorage.removeItem(e.toUpperCase()+"_DEBUG")}catch(n){l(e.toUpperCase()+"_DEBUG",t||void 0)}else{t=null==e||e;try{t?localStorage.setItem("DEBUG",JSON.stringify(t)):localStorage.removeItem("DEBUG")}catch(e){l("DEBUG",t||void 0)}}}}}(document.location);const le="na1",de={APP:"app",APP_API:"app-api"};function he(e){const t=e&&e.hubletOverride?e.hubletOverride:ue.getHublet();return t===le?"":"-"+t}function pe(e,t){if(t&&t.hubletPostfixLocation&&"domain"===t.hubletPostfixLocation)return e;e===de.APP_API&&(e=de.APP);return`${e}${he(t)}`}function ge(e){return`${Ee(e)}${me(e)}${fe(e)}`}function me(e){return"qa"===(e&&e.envOverride?e.envOverride:ue.getShort())?"qa":""}function Ee(e){return e&&e.domainOverride?e.domainOverride:"hubspot"}function fe(e){return e&&e.hubletPostfixLocation&&"domain"===e.hubletPostfixLocation?he(e):""}function De(e){return e&&e.tldOverride?e.tldOverride:"com"}function _e(e){return e===de.APP_API?"/api":""}function be(e,t){return`https://${pe(e,t)}.${ge(t)}.${De(t)}${_e(e)}`}var ye={id:null,pathRegex:/^\/(?:[A-Za-z0-9-_]*)\/(\d+)(?:\/|$)/,queryParamRegex:/(?:\?|&)portalid=(\d+)/i,getPortalIdFromPath(e){if(document){null==e&&(e=this.pathRegex);return this.parsePortalIdFromString(document.location.pathname,e)}},getPortalIdFromQueryParam(){if(document)return this.parsePortalIdFromString(document.location.search,this.queryParamRegex)},parsePortalIdFromString(e,t){const n=t.exec(e),s=null!=n?n[1]:void 0;return s?+s:void 0},get(e){null==e&&(e={});if(this.id&&!e.reparse)return this.id;const t=this.getPortalIdFromPath(e.regex)||this.getPortalIdFromQueryParam();if(!e.preserveGlobalId){null==window.hubspot&&(window.hubspot={});null==window.hubspot.portal&&(window.hubspot.portal={});null==window.hubspot.portal.id&&(window.hubspot.portal.id=t);t&&(this.id=t)}return t}};function Ie(){const e=te().messageDebug,t=te().localEmbed,n=e&&t?"local":"app",s=J();return`${be(n)}/calling-cross-tab-embed/${ye.get()}/embed?${oe({connectionType:s.connectionType,origin:encodeURIComponent(window.location.origin)})}`}const Ae="__calling_cross_tab_message";let we;!function(e){e.UPDATED_APP_DATA="UPDATED_APP_DATA";e.UPDATED_WIDGET_DETAILS="UPDATED_WIDGET_DETAILS"}(we||(we={}));const Te=e=>e&&e.type===we.UPDATED_APP_DATA,Se=e=>e&&e.type===we.UPDATED_WIDGET_DETAILS;function Ce(){let e="#";for(let t=0;t<3;t++)e+=("0"+Math.floor((1+Math.random())*Math.pow(16,2)/2).toString(16)).slice(-2);return e}class Ne{constructor(e){this._color=Ce();this.connectionType="";this.log=(...e)=>{let t=`%c[${this.connectionType?this.connectionType.toLowerCase()+"-":""}${this._prefix}]: `;if(console.groupCollapsed&&e.length>1){const[n,...s]=e;if(Array.isArray(n)){const[e,s]=n;t+=e;console.groupCollapsed(t,`color:${this._color};`,s)}else{t+=n;console.groupCollapsed(t,`color:${this._color};`)}console.log(...s);console.groupEnd();return}const[n,...s]=e;t+=n;console.log(t,`color:${this._color};`,...s)};this._prefix=e}}const Re="calling-cross-tab-client";let Oe;const ve=Z(()=>{try{if(te().messageDebug){if(Oe)return Oe.log;Oe=new Ne(Re);return Oe.log}}catch(e){}}),Me=(...e)=>{const t=ve();t&&t(...e)};function Ue(e,t){let n;const s=t||{};try{n=new CustomEvent(e,{detail:s})}catch(t){n=document.createEvent("CustomEvent");n.initCustomEvent(e,!1,!1,s)}Me("Dispatching event "+n.type,n);window.dispatchEvent(n)}const Pe=(e,t)=>{Ue(I,{appData:e,updates:t})};function Le({appData:e,updates:t}){Gt.appData=e;t.length>0&&Pe(e,t)}const je=e=>{if(Se(e)||Te(e)){Me(`Received Worker Message ${e.type} message`,e);Le(e.payload)}},Be=e=>{const t=J();if(0!==t.broadcastMessageHandlers.length){Me(`Received Message ${e.type}, sending to ${t.broadcastMessageHandlers.length} callback(s)`,e);t.broadcastMessageHandlers.forEach(t=>{t(e)})}},Ge=e=>{const t=J();return Object.assign({},e,{format:Ae,version:m,originConnectionId:t.connectionId})},$e="CALLING_CROSS_TAB_MESSAGING_READY",xe="CALLING_CROSS_TAB_MESSAGING_UNSUPPORTED",Fe=Z(()=>Boolean(window.SharedWorker)&&Boolean(window.BroadcastChannel));let We,ke;!function(e){e.MISSING_SHARED_WORKER_SUPPORT="MISSING_SHARED_WORKER_SUPPORT";e.UNSUPPORTED_USER_AGENT="UNSUPPORTED_USER_AGENT";e.EMBEDDED="EMBEDDED";e.INAPPLICABLE="INAPPLICABLE"}(We||(We={}));const qe=()=>{if("boolean"==typeof ke)return ke;try{ke=window.top!==window}catch(e){ke=!0}return ke},He=()=>{const e=navigator.userAgent;if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e))return!1;const t=e?navigator.userAgent.toLowerCase():"";return!(t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("edge/"))};let Qe;const Ke=()=>{void 0===Qe&&(Qe=Fe()&&He());return Qe};let ze;const Ye=()=>{if("string"==typeof ze)return ze;ze=We.INAPPLICABLE;Ke()?qe()&&(ze=We.EMBEDDED):ze=He()?We.MISSING_SHARED_WORKER_SUPPORT:We.UNSUPPORTED_USER_AGENT;return ze},Ze="CALLING_CONNECTION_STATUS_UPDATE",Je=e=>{Ue(Ze,{status:e})};var Ve=n(0);function Xe(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){t.push(n);t.push(String(e[n]))}return t.sort().toString()}const et=60*1e3;let tt;function nt(e,t){const n=Object(Ve.a)();return tt?tt(e,t):n.navigator&&n.navigator.sendBeacon(e,t)}function st(e,t=""){if(nt)try{nt(e,t)}catch(e){}}const ot={package:Object(Ve.b)()&&Object(Ve.b)().bender&&Object(Ve.b)().bender.currentProject||"unknown",version:Object(Ve.b)()&&Object(Ve.b)().bender&&Object(Ve.b)().bender.currentProjectVersion||"unknown"};function it(){return`https://metrics-fe-${ue.getHublet()}.hubspot${ue.isQa()?"qa":""}.com/metrics/v1/frontend/custom/send?hs_static_app=${ot.package}&hs_static_app_version=${ot.version}`}function rt(e){if(ue.deployed("METRICS")){ue.debug("METRICS")&&console.log("[metrics-js] Datapoint sent",e);st(it(),JSON.stringify(e))}else ue.debug("METRICS")&&console.log("[metrics-js] Dropping local datapoint",e)}let at=null;const ct="__metricsJsDisabled";const ut=()=>!("object"!=typeof window.safari||!window.safari.pushNotification);class lt{constructor(){this.metrics=new Map;this.interval=void 0;this.flush=(e=!1)=>{const t=[];this.metrics.forEach(n=>{n.canFlush(e)&&t.push(n.flush())});t.length>0&&rt(t)};this.eagerlyFlushQueueOnUnload=()=>{"hidden"!==document.visibilityState&&"beforeunload"!==this.listenTo||this.stop()};this.listenTo=ut()?"beforeunload":"visibilitychange"}static instance(){at=at||new lt;return at}clearMetricCache(){this.metrics.clear()}run(){if(!(Object(Ve.a)()&&Object(Ve.a)().hubspot&&Object(Ve.a)().hubspot[ct]||this.interval)){this.interval=setInterval(this.flush,et);this.interval.unref&&this.interval.unref();try{window.addEventListener(this.listenTo,this.eagerlyFlushQueueOnUnload,!0)}catch(e){}}}stop(){clearInterval(this.interval);this.interval=void 0;this.flush(!0);this.clearMetricCache();try{window.removeEventListener(this.listenTo,this.eagerlyFlushQueueOnUnload)}catch(e){}}getMetricCacheKey(e,t){return`${e}-${Xe(t)}`}getMetric(e,t,n){const s=this.getMetricCacheKey(e,t);if(this.metrics.has(s))return this.metrics.get(s);const o=new n(e,t);this.metrics.set(s,o);return o}}class dt{constructor(e,t){this.name=e;this.dimensions=t}getDimensions(){return this.dimensions}getName(){return this.name}getSeries(e){return[this.name,e].join(".")}toString(){return JSON.stringify({name:this.getName(),dimensions:this.getDimensions()},null,2)}}class ht extends dt{constructor(...e){super(...e);this.count=0;this.hasUpdated=!1}safeStep(e){if("number"!=typeof e||e%1==0){this.hasUpdated=!0;this.count+=e}else 0}increment(e=1){this.safeStep(e)}decrement(e=1){this.safeStep(-1*e)}canFlush(e=!1){return this.hasUpdated}flush(){const e={name:this.getName(),values:[this.count],type:"COUNTER",dimensions:this.getDimensions()};this.count=0;this.hasUpdated=!1;return e}}class pt extends dt{constructor(...e){super(...e);this.values=[]}update(e){this.values.push(e)}canFlush(){return this.values.length>0}flush(){const e={name:this.getName(),type:"HISTOGRAM",values:this.values.slice(),dimensions:this.getDimensions()};this.values=[];return e}}class gt extends ht{canFlush(e){return e}flush(){const e=super.flush();e.type="HISTOGRAM";return e}}function mt(e){return e&&"function"==typeof e.then}class Et extends dt{constructor(...e){super(...e);this.values=[]}update(e){this.values.push(e)}time(e){const t=performance.now(),n=e();if(mt(n))return n.then(e=>{this.update(performance.now()-t);return e});this.update(performance.now()-t);return n}canFlush(){return this.values.length>0}flush(){const e={name:this.getName(),type:"TIMER",values:this.values.slice(),dimensions:this.getDimensions()};this.values=[];return e}}const ft=Symbol("SessionCounter");class Dt{constructor(e,t={}){this.namespace=e;this.globalDimensions=t}namespaceMetric(e){return`${this.namespace}.${e}`}counter(e,t={}){return lt.instance().getMetric(this.namespaceMetric(e),Object.assign({},this.globalDimensions,{},t),ht)}[ft](e,t={}){return lt.instance().getMetric(this.namespaceMetric(e),Object.assign({},this.globalDimensions,{},t),gt)}histogram(e,t={}){return lt.instance().getMetric(this.namespaceMetric(e),Object.assign({},this.globalDimensions,{},t),pt)}timer(e,t={}){return lt.instance().getMetric(this.namespaceMetric(e),Object.assign({},this.globalDimensions,{},t),Et)}}let _t;function bt(e){Object(Ve.b)().__metricsSetupComplete=e}function yt(){return Object(Ve.b)().__metricsSetupComplete}function It(){if(!_t&&!yt()){_t=new Dt("metrics",{});_t.counter("loaded").increment();bt(!0)}}let At,wt=window;const Tt=new Set;function St(e){wt=e||wt;if(!At){At=new Dt("js",{});try{wt.addEventListener("error",vt);wt.addEventListener("unhandledrejection",Rt);wt.addEventListener("rejectionhandled",Ot)}catch(e){}}}const Ct=/@<inline>|moz-extension:\/\/|chrome-extension:\/\/|safari-web-extension:\/\/|safari-extension:\/\//;function Nt(e){if(e&&e.stack&&e.stack.match(Ct)){At&&At.counter("browser-extension-errors").increment();return!0}return!1}function Rt(e){At&&(e.reason&&Nt(e.reason)||At.counter("unhandled-promise-rejection").increment())}function Ot(){At&&At.counter("handled-promise-rejection").increment()}function vt(e){if(!At)return;if(!(e instanceof ErrorEvent))return;const t=e.error||new Error(e.message);if(!Tt.has(t))if(Mt(t))At.counter("configured-ignored-errors").increment();else if(!Nt(t)){At.counter("errors").increment();At[ft]("errors-per-session").increment();Tt.add(t);Ut(t)}}function Mt(e){return!!(window.hubspot&&window.hubspot._shouldIgnoreJsError&&window.hubspot._shouldIgnoreJsError(e))}function Ut(e){setTimeout(()=>Tt.delete(e),250)}function Pt(){const e=lt.instance();e.run();return e}function Lt(e,t={}){if(!e)throw new Error("[metrics-js] A namespace is required for a Metrics factory.");Pt();St();const n=t.dimensions||{};t.library&&(n.fe_library=t.library);return new Dt(e,n)}It();const jt=Z(()=>Lt("calling-cross-tab-messaging",{dimensions:{crossTabMessagingSupport:""+Ke(),connectionVersion:m}}));class Bt{constructor(){this.isInitialized=!1;this.isReady=!1;this.appData=D();this.connectionStatus=l.UNINITIALIZED;this.unsupportedReason=Ye();this.getConnectionStatus=()=>this.connectionStatus;this._handleEmbedReadyMessage=e=>{const t=e.payload,n=y(t);this._updateConnectionStatus(n);if(n===l.SUCCEEDED){Le({appData:t,updates:Object.keys(t)});this.isReady=!0;Ue($e)}};this._handleWorkerStatusUpdateMessage=e=>{this._updateConnectionStatus(e.payload.status);e.payload.appData&&Le({appData:e.payload.appData,updates:Object.keys(e.payload.appData)})};this._handleEmbedMessage=e=>{w(e)?je(e):T(e)?Be(e):u(new r({message:`Unknown Message Type ${e&&e.type||e.type} from crosstab embed`}),{extra:{message:e}})};this._updateConnectionStatus=(e,t=!0)=>{this.connectionStatus=e;if(e===l.FAILED){if(t){const e=new r({message:"Worker Connection Status Failed"});u(e)}this.appData=b();Pe(this.appData,Object.keys(this.appData))}Je(e)};this.sendMessage=e=>{if([l.FAILED,l.UNSUPPORTED].includes(this.connectionStatus))return;if(!S(e)){u(new r({message:"The following message type is not properly formatted: "+(e&&e.type?e.type:"Unknown")}),{extra:{message:e}});return}const t=Ge(e);this._embedMessageConnection.sendMessage(t)};this.initialize=()=>{this.isInitialized=!0;if(this.unsupportedReason!==We.INAPPLICABLE){this._updateConnectionStatus(l.UNSUPPORTED);Ue(xe);jt().counter("unsupported",{isAsyncFile:"true",unsupportedReason:this.unsupportedReason});return Promise.resolve()}this._updateConnectionStatus(l.STARTED);return this._embedMessageConnection.initialize().catch(()=>{this._updateConnectionStatus(l.FAILED,!1)})};const e=J();this._embedMessageConnection=new z({connectionId:e.connectionId,embedUrl:Ie(),embedName:E,logClientDebug:Me,onEmbedMessage:this._handleEmbedMessage,onEmbedReadyMessage:this._handleEmbedReadyMessage,onWorkerStatusUpdateMessage:this._handleWorkerStatusUpdateMessage})}}var Gt=new Bt;(()=>{try{window.hsCallingWorkerEmbedConnection=window.hsCallingWorkerEmbedConnection||Gt;window.hsCallingWorkerEmbedConnection.initialize();i()}catch(e){window.hsCallingWorkerEmbedConnection&&(window.hsCallingWorkerEmbedConnection=void 0);const t=new r({message:"Error assigning Shared Worker connection client",details:{actualError:e},criticalFailure:!0});u(t)}})()}]);
//# sourceMappingURL=asyncStart.js.map